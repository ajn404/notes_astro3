/*! css-doodle@0.38.3 */(function(){const Sr=[":",";",",","(",")","[","]","{","}","π","±","+","-","*","/","%",'"',"'","`","@","=","^"],$={escape:e=>e=="\\",space:e=>/[\r\n\t\s]/.test(e),digit:e=>/^[0-9]$/.test(e),sign:e=>/^[+-]$/.test(e),dot:e=>e==".",quote:e=>/^["'`]$/.test(e),symbol:e=>Sr.includes(e),hexNum:e=>/^[0-9a-f]$/i.test(e),hex:(e,r,t)=>e=="0"&&$.letter(r,"x")&&$.hexNum(t),expWithSign:(e,r,t)=>$.letter(e,"e")&&$.sign(r)&&$.digit(t),exp:(e,r)=>$.letter(e,"e")&&$.digit(r),dots:(e,r)=>$.dot(e)&&$.dot(r),letter:(e,r)=>String(e).toLowerCase()==String(r).toLowerCase(),comment:(e,r)=>e=="/"&&r=="*",inlineComment:(e,r)=>e=="/"&&r==="/",selfClosedTag:(e,r)=>e=="/"&&r==">",closedTag:(e,r)=>e=="<"&&r=="/"};class H{constructor({type:r,value:t,pos:n,status:i}){this.type=r,this.value=t,this.pos=n,i&&(this.status=i)}isSymbol(...r){let t=this.type=="Symbol";return r.length?r.some(n=>n===this.value):t}isSpace(){return this.type=="Space"}isNumber(){return this.type=="Number"}isWord(){return this.type=="Word"}}function I(e){let r=-1,t=e.length,n=-1,i=0;return{curr:(s=0)=>e[r+s],next(s=1){let o=e[r+=s];return o===`
`?(i++,n=0):n+=s,o},end:()=>r>=t,get:()=>({prev:e[r-1],curr:e[r+0],next:e[r+1],next2:e[r+2],next3:e[r+3],pos:[n,i]})}}function jr(e){for(;e.next();){let{curr:r,prev:t}=e.get();if($.comment(r,t))break}}function Ar(e){for(;e.next()&&e.curr()!==`
`;);}function yt(e){return[":",";",",","{","}","(",")","[","]"].includes(e)}function bt(e){let r="";for(;!e.end();){let{curr:t,next:n}=e.get();r+=t;let i=$.symbol(n)||$.space(n)||$.digit(n);if(r.length&&i&&!$.closedTag(t,n))break;e.next()}return r.trim()}function Nr(e){let r="";for(;!e.end();){let{curr:t,next:n}=e.get();if(r+=t,!$.space(n))break;e.next()}return r}function xt(e){let r="",t=!1;for(;!e.end();){let{curr:n,next:i,next2:s,next3:o}=e.get();if(r+=n,t&&$.dot(i)||($.dot(n)&&(t=!0),$.dots(i,s)))break;if($.expWithSign(i,s,o))r+=e.next()+e.next();else if($.exp(i,s))r+=e.next();else if(!$.digit(i)&&!$.dot(i))break;e.next()}return r}function Er(e){let r="0x";for(e.next(2);!e.end();){let{curr:t,next:n}=e.get();if(r+=t,!$.hexNum(n))break;e.next()}return r}function ve(e){return e[e.length-1]}function D(e,r={}){let t=I(String(e).trim()),n=[],i=[];for(;t.next();){let{prev:o,curr:l,next:a,next2:u,pos:c}=t.get();if($.comment(l,a))jr(t);else if(r.ignoreInlineComment&&$.inlineComment(l,a))Ar(t);else if($.hex(l,a,u)){let h=Er(t);n.push(new H({type:"Number",value:h,pos:c}))}else if($.digit(l)||$.digit(a)&&$.dot(l)&&!$.dots(o,l)){let h=xt(t);n.push(new H({type:"Number",value:h,pos:c}))}else if($.symbol(l)&&!$.selfClosedTag(l,a)){let h=ve(n),p=$.digit(a)||$.dot(a)&&$.digit(u);if(l==="-"&&p&&(!h||!h.isNumber())){let d=xt(t);n.push(new H({type:"Number",value:d,pos:c}));continue}let f={type:"Symbol",value:l,pos:c};if(i.length&&$.escape(h.value)){n.pop();let d=bt(t);d.length&&n.push(new H({type:"Word",value:d,pos:c}))}else $.quote(l)&&(ve(i)==l?(i.pop(),f.status="close"):(i.push(l),f.status="open")),n.push(new H(f))}else if($.space(l)){let h=Nr(t),p=ve(n),{next:f}=t.get();if(!i.length&&p){let d=p.value,m=yt(d)&&d!==")",x=yt(f)&&f!=="(";if(m||x)continue;h=r.preserveLineBreak?l:" "}n.length&&f&&f.trim()&&n.push(new H({type:"Space",value:h,pos:c}))}else{let h=bt(t);h.length&&n.push(new H({type:"Word",value:h,pos:c}))}}let s=ve(n);return s&&s.isSpace()&&(n.length=n.length-1),n}function _t(e){let r=[];for(;e.next();){let{curr:t,next:n}=e.get();if(t.value==="var"){if(n&&n.isSymbol("(")){e.next();let i=Tr(e);Rr(i.name)&&r.push(i)}}else if(r.length&&!t.isSymbol(","))break}return r}function Tr(e){let r={},t=[];for(;e.next();){let{curr:n,next:i}=e.get();if(n.isSymbol(")",";")&&!r.name){r.name=$t(t);break}n.isSymbol(",")?(r.name===void 0&&(r.name=$t(t),t=[]),r.name&&(r.fallback=_t(e))):t.push(n)}return r}function $t(e){return e.map(r=>r.value).join("")}function Rr(e){return e!==void 0&&!(e.length<=2)&&!e.substr(2).startsWith("-")&&!!e.startsWith("--")}function L(e,r,t){return e=Number(e)||0,Math.max(r,Math.min(t,e))}function Le(e,r){for(let[t,n]of Object.entries(r))e[t]=e[n];return e}function De(e){return/^[a-zA-Z]$/.test(e)}function j(e){return e==null}function Q(e){return j(e)||Number.isNaN(e)}function B(e){return j(e)||e===""}function V(e){let r=t=>(...n)=>e(t,...n);return r.lazy=!0,r}function ee(e,r,t){return"c-"+e+"-"+r+"-"+t}function E(e){let r=e;for(;r&&!j(r.value);)r=r.value;return j(r)?"":r}function wt(e,r,t=0){let n=new Image;n.crossOrigin="anonymous",n.src=e,n.onload=function(){setTimeout(r,t)}}function Be(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}function kt(e){let r=document.createElement("textarea");return r.innerHTML=e,r.value}function St(e,r=0){let t=3735928559^r,n=1103547991^r;for(let i,s=0;s<e.length;s++)i=e.charCodeAt(s),t=Math.imul(t^i,2654435761),n=Math.imul(n^i,1597334677);return t=Math.imul(t^t>>>16,2246822507)^Math.imul(n^n>>>13,3266489909),n=Math.imul(n^n>>>16,2246822507)^Math.imul(t^t>>>13,3266489909),4294967296*(2097151&n)+(t>>>0)}function U(e,r,t){return r+e*(t-r)}function ye(e=""){return e+Math.random().toString(32).substr(2)}function be(e){return j(e)?[]:Array.isArray(e)?e:[e]}function xe(e,r=`
`){return(e||[]).join(r)}function A(e,r=1){return j(e)?"":e[e.length-r]}function jt(e){return e[0]}function z(e,r={symbol:",",noSpace:!1,verbose:!1}){let t=[],n=[],i=[],s=[],o="";if(B(e))return t;let l=I(D(e));function a(c){let h=r.symbol||[","];return Array.isArray(h)||(h=[h]),r.noSpace?c.isSymbol(...h):c.isSymbol(...h)||c.isSpace()}function u(c){let h=function(p){return p.map(f=>f.value).join("")}(c);r.verbose?(o.length||h.length)&&t.push({group:o,value:h}):t.push(h)}for(;l.next();){let{prev:c,curr:h,next:p}=l.get();h.isSymbol("(")&&i.push(h.value),h.isSymbol(")")&&i.pop(),h.status==="open"&&s.push(h.value),h.status==="close"&&s.pop();let f=!i.length&&!s.length;if(f){let d=r.noSpace&&h.isSpace()&&a(p),m=r.noSpace&&h.isSpace()&&a(c);if(d||m)continue}f&&a(h)?(u(n),o=h.value,n=[]):n.push(h)}return n.length&&u(n),t}function zr(e,r){let t,n=[],i=[],s=[],o=!1;for(;e.next();){let{curr:l,next:a}=e.get();l.isSymbol("(")&&!i.length?s.push(l):l.isSymbol(")")&&!i.length&&s.pop(),l.isSymbol("'",'"')&&(l.status==="open"?i.push(l):i.pop());let u=!i.length&&!s.length&&(!a||l.isSymbol(";")||a.isSymbol("}"));if(l.isSymbol("'",'"')&&a&&a.isSymbol("}")&&!i.length&&(u=!0),!s.length&&!i.length&&l.isSymbol("{")){let c=At(n);if(!c.length)continue;let h=c.pop(),p=Fe(...c,h);for(t=_e(Ue(e,$e(h,{type:"block",name:h,value:[]})),p);h=c.pop();)t=_e($e(h,{type:"block",name:h,value:[t]}),p);o=!0;break}if(n.push(l),u)break}return n.length&&!t?(r._valueTokens=n,r.value=te(n)):t&&(r.value=t),o&&(r.value.inline=!0),r.origin&&(r.origin.value=r.value),r}function Cr(e){let r=[],t=[];for(;e.next();){let{curr:n}=e.get();if(n.isSymbol("{"))r.push(n.value);else if(n.isSymbol("}")){if(!r.length)break;r.pop()}t.push(n.value)}return t.join("")}function Ue(e,r){let t=[],n=[],i=r&&r.type||"",s=[];for(;e.next();){let{prev:o,curr:l,next:a}=e.get();l.isSymbol("(")&&s.push(l.value),l.isSymbol(")")&&s.pop();let u=!a||l.isSymbol("}");if(Xe(i)&&u){!a&&t.length&&!l.isSymbol("}")&&typeof t[t.length-1].value=="string"&&(t[t.length-1].value+=";"+l.value),r.value=t;break}if(l.isSymbol("{")){let c=At(n);if(!c.length)continue;Fe(r.name)&&(c=[te(n)]);let h=c.pop(),p=Fe(...c,r.name,h);if(h==="style")t.push({type:"block",name:h,value:Cr(e)});else{let f=_e(Ue(e,$e(h,{type:"block",name:h,value:[]})),p);for(;h=c.pop();)f=_e($e(h,{type:"block",name:h,value:[f]}),p);t.push(f)}n=[]}else if(l.isSymbol(":")&&!s.length&&!Mr(o,a)&&n.length){let c=Pr(n,m=>m.isSymbol(",")),h={type:"statement",name:"unkown",value:""};c.length>1&&(h.origin={name:c});let p=zr(e,h),f=z(p.value),d=c.length>1&&f.length===c.length;c.forEach((m,x)=>{let g=Object.assign({},p,{name:m});/^\-\-/.test(m)&&(g.variable=!0),d&&(g.value=f[x]),/viewBox/i.test(m)&&(g.detail=Or(g.value,g._valueTokens)),delete g._valueTokens,t.push(g)}),Xe(i)&&(r.value=t),n=[]}else l.isSymbol(";")?t.length&&n.length&&(t[t.length-1].value+=";"+te(n),n=[]):n.push(l)}return t.length&&Xe(i)&&(r.value=t),i?r:t}function Mr(e,r){let t=e&&e.value,n=r&&r.value;return["xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space"].includes(t+":"+n)}function te(e){return e.filter((r,t)=>!r.isSymbol(";","}")||t!==e.length-1).map(r=>r.value).join("")}function _e(e,r){let t=e.name||"",[n,...i]=t.split(/#/),s=i[i.length-1];return n&&s&&!r&&(e.name=n,e.value.push({type:"statement",name:"id",value:s})),e}function Pr(e,r){let t=[],n=[];return e.forEach(i=>{r(i)?(t.push(te(n)),n=[]):n.push(i)}),n.length&&t.push(te(n)),t}function At(e){let r,t=[],n=I(e);for(;n.next();){let{prev:i,curr:s,next:o}=n.get(),l=i&&o&&s.value==="x"&&i.isNumber()&&o.isNumber();!s.isWord()||r||l?t[t.length-1]=(t[t.length-1]+s.value).trim():t.push(s.value.trim()),s.isSymbol()?r=!0:s.isSpace()||(r=!1)}return t}function Or(e,r){const t={value:[]};let n;if(!Array.isArray(r))return t;for(let i of r)i.isSpace()||i.isSymbol(",",";")||(t.value.length<4&&i.isNumber()?t.value.push(Number(i.value)):i.isNumber()&&n?(t[n]=Number(i.value),n=null):i.isWord()&&(n=i.value));return t}function $e(e,r){let t=Object.assign({},r);if(/\*\s*[0-9]/.test(e)){let[n,i]=e.split("*");i&&(t.times=i.trim(),t.pureName=n.trim())}return t}function Fe(...e){return e.some(r=>r==="style")}function Xe(e){return e==="block"}function re(e,r){return function(t){let n,i=[];for(let s of t.value)s.name==="svg"&&(n=s),s.variable&&i.push(s);if(n&&Array.isArray(n.value)){for(let s of i)n.value.find(o=>o.name==s.name)||n.value.unshift(s);return n}return t}(Ue(I(D(e)),r||{type:"block",name:"svg",value:[]}))}function qe(e,r){let t="";if(e.type==="block"){let n=Array.isArray(e.value)&&e.value[0]&&e.value[0].inline;if(e.times?t+="@M"+e.times+"("+e.pureName+"{":t+=e.name+"{",e.name==="style")t+=e.value;else if(Array.isArray(e.value)&&e.value.length){let i="";for(let s of e.value)t+=qe(s,i),s.origin&&(i=s.origin.name.join(","))}e.times?t+="})":n||(t+="}")}else if(e.type==="statement"){let n=e.origin&&r===e.origin.name.join(","),i=e.origin?e.origin.name.join(","):e.name,s=e.origin?e.origin.value:e.value;n||(t+=s&&s.type?i+":"+qe(s):i+":"+s+";")}return t}function Ir(e){return qe(e).trim()}const W={func:(e="")=>({type:"func",name:e,arguments:[]}),argument:()=>({type:"argument",value:[]}),text:(e="")=>({type:"text",value:e}),pseudo:(e="")=>({type:"pseudo",selector:e,styles:[]}),cond:(e="")=>({type:"cond",name:e,styles:[],arguments:[]}),rule:(e="")=>({type:"rule",property:e,value:[]}),keyframes:(e="")=>({type:"keyframes",name:e,steps:[]}),step:(e="")=>({type:"step",name:e,styles:[]})},P={white_space:e=>/[\s\n\t]/.test(e),line_break:e=>/\n/.test(e),number:e=>!isNaN(e),pair:e=>['"',"(",")","'"].includes(e),pair_of:(e,r)=>({'"':'"',"'":"'","(":")"})[e]==r},we={π:Math.PI,"∏":Math.PI};function Nt(e){return/^@(canvas|shaders|doodle)/.test(e)}function Et(e=""){let r=0,t=1,n=1;return{curr:(i=0)=>e[r+i],end:()=>e.length<=r,info:()=>({index:r,col:t,line:n}),index:i=>i===void 0?r:r=i,range:(i,s)=>e.substring(i,s),next(){let i=e[r++];return i==`
`?(n++,t=0):t++,i}}}function Wr(e,{col:r,line:t}){console.warn(`(at line ${t}, column ${r}) ${e}`)}function He(e){return function(r,t){let n=r.index(),i="";for(;!r.end();){let s=r.next();if(e(s))break;i+=s}return t&&r.index(n),i}}function Tt(e,r){return He(t=>/[^\w@]/.test(t))(e,r)}function Lr(e){return He(r=>/[\s\{]/.test(r))(e)}function Rt(e,r){return He(t=>P.line_break(t)||t=="{")(e,r)}function Dr(e,r){let t,n=W.step();for(;!e.end()&&(t=e.curr())!="}";)if(P.white_space(t))e.next();else{if(n.name.length){if(n.styles.push(Se(e,r)),e.curr()=="}")break}else n.name=Ve(e,i=>i==="{");e.next()}return n}function Br(e,r){const t=[];let n;for(;!e.end()&&(n=e.curr())!="}";)P.white_space(n)||t.push(Dr(e,r)),e.next();return t}function Ur(e,r){let t,n=W.keyframes();for(;!e.end()&&(t=e.curr())!="}";)if(n.name.length){if(t=="{"||e.curr(-1)=="{"){e.next(),n.steps=Br(e,r);break}e.next()}else if(Tt(e),n.name=Lr(e),!n.name.length){Wr("missing keyframes name",e.info());break}return n}function ke(e,r={}){for(e.next();!e.end();){let t=e.curr();if(r.inline){if(t==`
`)break}else if((t=e.curr())=="*"&&e.curr(1)=="/")break;e.next()}r.inline||(e.next(),e.next())}function Fr(e){for(e.next();!e.end()&&e.curr()!=">";)e.next()}function Xr(e){let r,t="";for(;!e.end()&&(r=e.curr())!=":";)P.white_space(r)||(t+=r),e.next();return t}function Ye(e,r,t,n={}){let i,s=[],o=[],l=[],a="",u="";for(;!e.end();){i=e.curr();let h=e.curr(-1),p=e.index();if(/[\('"`]/.test(i)&&h!=="\\")l.length&&i!=="("&&i===A(l)?l.pop():l.push(i),a+=i;else if(!t&&(i=="@"||i==="$"||h==="."&&r))o.length||(a=a.trimLeft()),a.length&&(o.push(W.text(a)),a=""),o.push(zt(e,n));else if(t&&/[)]/.test(i)||!t&&/[,)]/.test(i))if(l.length)i==")"&&A(l)==="("&&l.pop(),a+=i;else{if(a.length&&(o.length?/\S/.test(a)&&o.push(W.text(a)):o.push(W.text((c=a).trim().length?P.number(+c)?+c:c.trim():c)),a.startsWith("±")&&!t)){let f=a.substr(1),d=structuredClone(o);A(d).value="-"+f,s.push(Ge(d)),A(o).value=f}if(s.push(Ge(o)),[o,a]=[[],""],i==")")break}else we[i]&&!/[0-9]/.test(e.curr(-1))&&(i=we[i]),a+=i;if(!(!r||e.curr(1)!=")"&&e.curr(1)!=";"&&/[0-9a-zA-Z_\-.]/.test(e.curr())||l.length)){o.length&&s.push(Ge(o));break}u+=e.range(p,e.index()+1),e.next()}var c;return[qr(s),u]}function qr(e){let r=A(e[0]);return r&&r.type==="text"&&!String(r.value).trim().length&&(e[0]=e[0].slice(0,-1)),e}function Ge(e){let r=e.map(i=>{if(i.type=="text"&&typeof i.value=="string"){let s=String(i.value);s.includes("`")&&(i.value=s=s.replace(/`/g,'"')),i.value=s}return i}),t=jt(r)||{},n=A(r)||{};if(t.type=="text"&&n.type=="text"){let i=jt(t.value),s=A(n.value);typeof t.value=="string"&&typeof n.value=="string"&&P.pair_of(i,s)&&(t.value=t.value.slice(1),n.value=n.value.slice(0,n.value.length-1),r.cluster=!0)}return r}function Hr(e){let r=JSON.stringify(e);return r.includes("pureName")&&r.includes("times")}function Yr(e){return/^@svg$/i.test(e)}function zt(e,r={}){let t,n=W.func(),i=e.curr(),s=!1,o=i==="$";for(i==="@"?e.next():i="@";!e.end();){t=e.curr();let u=e.curr(1),c=t=="."&&/[a-zA-Z@$]/.test(u);if(t=="("||c){s=!0,e.next();let[h,p]=Ye(e,c,Nt(i),r);if(Yr(i)){let f=re(p),d=0;for(let m of f.value)m.variable&&(r[m.name]=Z(`${`
`.repeat(d++)} ${m.name}:${m.value}`)[0].value);if(/\d\s*{/.test(p)&&Hr(f)){let m=Ir(f);m+=")",h=Ye(Et(m),c,Nt(i),r)[0]}}n.arguments=h,n.variables=r;break}if(/[0-9a-zA-Z_\-.%]/.test(t)&&(i+=t),!s&&u!=="("&&!/[0-9a-zA-Z_\-.%]/.test(u))break;e.next()}let{fname:l,extra:a}=function(u){let c="",h="";if(/\D$/.test(u)&&!/\d+[x-]\d+/.test(u)||Math[u.substr(1)])return{fname:u,extra:h};for(let p=u.length-1;p>=0;p--){let f=u[p],d=u[p-1],m=u[p+1];if(!(/[\d.]/.test(f)||(f=="x"||f=="-")&&/\d/.test(d)&&/\d/.test(m))){c=u.substring(0,p+1);break}h=f+h}return{fname:c,extra:h}}(i);if(n.name=o?"@$"+i.substr(1):l,a.length&&n.arguments.unshift([{type:"text",value:a}]),o&&n.name.length>2){if(!n.arguments.length){let u=n.name.substring(0,2),c=n.name.substring(2);n.name=u,n.arguments.push([{type:"text",value:c}])}if(/\d$/.test(n.name)){let u=n.name.substring(0,2),c=n.name.substring(2);n.name=u,n.arguments[0][0].value=c}}return n.position=e.info().index,n}function Ve(e,r=()=>{}){let t,n=W.text(),i=0,s=!0;const o=[];o[i]=[];let l=[],a=[];for(;!e.end();){if(t=e.curr(),s&&P.white_space(t)){e.next();continue}if(s=!1,t!=`
`||P.white_space(e.curr(-1)))if(t!=","||l.length){if((/[;}<]/.test(t)||r(t))&&!a.length){n.value.length&&(o[i].push(n),n=W.text());break}t!=="@"&&t!=="$"||!/[\w-\(%]/.test(e.curr(1))?t==='"'||t==="'"?(t===A(a)?a.pop():a.length||a.push(t),n.value+=t):P.white_space(t)&&P.white_space(e.curr(-1))||(t=="("&&l.push(t),t==")"&&l.pop(),we[t]&&!/[0-9]/.test(e.curr(-1))&&(t=we[t]),n.value+=t):(n.value.length&&(o[i].push(n),n=W.text()),o[i].push(zt(e)))}else n.value.length&&(o[i].push(n),n=W.text()),o[++i]=[],s=!0;else n.value+=" ";let u=e.curr();if((u===";"||u=="}"||r(u))&&!a.length)break;e.next()}return n.value.length&&o[i].push(n),o}function Gr(e){let r,t="";for(;!e.end()&&(r=e.curr())!="{";)t+=r,e.next();return t=t.trim(),t}function Vr(e){let r,t={name:"",arguments:[]};for(;!e.end();){if((r=e.curr())=="(")e.next(),t.arguments=Ye(e)[0];else{if(/[){]/.test(r))break;t.name+=r}e.next()}let[n,...i]=t.name.trim().split(/\s+/);return t.name=n,t.addition=i,t}function Ct(e,r){let t,n=W.pseudo();for(;!e.end();){if(t=e.curr(),t=="/"&&e.curr(1)=="*")ke(e);else{if(t=="}")break;if(P.white_space(t)){e.next();continue}if(n.selector){let i=Se(e,r);if(i.property=="@use"?n.styles=n.styles.concat(i.value):i.property&&n.styles.push(i),e.curr()=="}")break}else n.selector=Gr(e)}e.next()}return n}function Se(e,r){let t,n=W.rule(),i=e.index();for(;!e.end();){if(t=e.curr(),t=="/"&&e.curr(1)=="*")ke(e);else{if(t==";")break;if(n.property.length){n.value=Ve(e);break}if(n.property=Xr(e),n.property=="@use"){n.value=Zr(e,r);break}}e.next()}let s=e.index();return n.raw=()=>e.range(i,s).trim(),n}function Mt(e,r){let t,n=W.cond();for(;!e.end();){if(t=e.curr(),t=="/"&&e.curr(1)=="*")ke(e);else{if(t=="}")break;if(n.name.length)if(t==":"){let i=Ct(e);i.selector&&n.styles.push(i)}else if(t!="@"||Rt(e,!0).includes(":")){if(!P.white_space(t)){let i=Se(e,r);if(i.property&&n.styles.push(i),e.curr()=="}")break}}else n.styles.push(Mt(e));else Object.assign(n,Vr(e))}e.next()}return n}function Pt(e,r){let t="";return e&&e.get_variable&&(t=e.get_variable(r)),t}function Ot(e,r){e.forEach&&e.forEach(t=>{if(t.type=="text"&&t.value){let n=_t(I(D(t.value)));t.value=n.reduce((i,s)=>{let o,l="",a="";l=Pt(r,s.name),!l&&s.fallback&&s.fallback.every(u=>{if(a=Pt(r,u.name),a)return l=a,!1});try{o=Z(l,r)}catch{}return o&&i.push.apply(i,o),i},[])}t.type=="func"&&t.arguments&&t.arguments.forEach(n=>{Ot(n,r)})})}function Zr(e,r){return e.next(),(Ve(e)||[]).reduce((t,n)=>{Ot(n,r);let[i]=n;return i.value&&i.value.length&&t.push(...i.value),t},[])}function Z(e,r){const t=Et(e),n=[];for(;!t.end();){let i=t.curr();if(P.white_space(i))t.next();else{if(i=="/"&&t.curr(1)=="*")ke(t);else if(i==":"){let s=Ct(t,r);s.selector&&n.push(s)}else if(i=="@"&&Tt(t,!0)==="@keyframes"){let s=Ur(t,r);n.push(s)}else if(i!="@"||Rt(t,!0).includes(":")){if(i=="<")Fr(t);else if(!P.white_space(i)){let s=Se(t,r);s.property&&n.push(s)}}else{let s=Mt(t,r);s.name.length&&n.push(s)}t.next()}}return n}function ne(e,r=64){const[t,n,i]=[1,r,r*r];let[s,o,l]=(e+"").replace(/\s+/g,"").replace(/[,\uff0cxX]+/g,"x").split("x").map(h=>parseInt(h));const a=s==1||o==1?i:n,u=s==1&&o==1?i:t,c={x:L(s||t,1,a),y:L(o||s||t,1,a),z:L(l||t,1,u)};return Object.assign({},c,{count:c.x*c.y*c.z,ratio:c.x/c.y})}function Kr(e){return/^texture\w*$|^(fragment|vertex)$/.test(e)}function It(){return new H({type:"LineBreak",value:`
`})}function Wt(e){let r=e[0],t=e[e.length-1];for(;r&&r.isSymbol("(")&&t&&t.isSymbol(")");)r=(e=e.slice(1,e.length-1))[0],t=e[e.length-1];return e}function Ze(e){return Wt(e).map(r=>r.value).join("")}const ie='xmlns="http://www.w3.org/2000/svg"',Lt='xmlns="http://www.w3.org/1999/xhtml"',Ke='xmlns:xlink="http://www.w3.org/1999/xlink"';function je(e,r){return`url("data:image/svg+xml;utf8,${encodeURIComponent(e)+(r?`#${r}`:"")}")`}function Dt(e){return e.includes("<svg")||(e=`<svg ${ie} ${Ke}>${e}</svg>`),e.includes("xmlns")||(e=e.replace(/<svg([\s>])/,`<svg ${ie} ${Ke}$1`)),e}function se(e){let r=I(D(e)),t={},n=!1;for(;r.next();){let{prev:i,curr:s,next:o}=r.get(),l=n&&(s.isWord()||s.isSymbol())&&i&&i.isNumber()&&!o;if(s.isNumber())t.value=Number(s.value),n=!0;else{if(!l)break;t.unit=s.value}}return t}function Bt(e){return(...r)=>{let t=[],n=[];for(let o of r){let{unit:l,value:a}=se(o);l!==void 0&&t.push(l),a!==void 0&&n.push(a)}let i=e(...n),s=t.find(o=>o!==void 0);return s===void 0?i:Array.isArray(i)?i.map(o=>o+s):i+s}}function Je(e){return(...r)=>{let t=r.map(i=>String(i).charCodeAt(0)),n=e(...t);return Array.isArray(n)?n.map(i=>String.fromCharCode(i)):String.fromCharCode(n)}}var K=new class{constructor(){this.cache={}}clear(){this.cache={}}set(e,r){if(j(e))return"";let t=this.getKey(e);return this.cache[t]=r}get(e){let r=this.getKey(e);return this.cache[r]}getKey(e){return St(typeof e=="string"?e:JSON.stringify(e))}};function Qe(e,r){return(...t)=>{let n=e+t.join("-");return K.get(n)||K.set(n,r(...t))}}function Ae(e,r){return{type:e,value:r}}function Jr(e,r,t){let n=0,i=e,s=a=>a>0&&a<1?.1:1,o=arguments.length;o==1&&([e,r]=[s(e),e]),o<3&&(t=s(e));let l=[];for(;(t>=0&&e<=r||t<0&&e>r)&&(l.push(e),e+=t,!(n++>=65535)););return l.length||l.push(i),l}const Qr=Qe("build_range",e=>function(t){let n=String(t),i=[],s=[];if(!n.startsWith("[")||!n.endsWith("]"))return i;for(let o=1;o<n.length-1;++o){let l=n[o];if(l!="-"||n[o-1]!="-")if(l!="-")if(A(s)!="-")s.length&&i.push(Ae("char",s.pop())),s.push(l);else{s.pop();let a=s.pop();i.push(a?Ae("range",[a,l]):Ae("char",l))}else s.push(l)}return s.length&&i.push(Ae("char",s.pop())),i}(e).flatMap(({type:t,value:n})=>{if(t=="char")return n;let[i,s]=n,o=!1;i>s&&([i,s]=[s,i],o=!0);let l=Je(Jr)(i,s);return o&&l.reverse(),l}));function le(e){return(...r)=>e(...r.flatMap(t=>String(t).startsWith("[")?Qr(t):t))}class en{constructor(r){this.prev=this.next=null,this.data=r}}class tn{constructor(r=20){this._limit=r,this._size=0}push(r){this._size>=this._limit&&(this.root=this.root.next,this.root.prev=null);let t=new en(r);this.root?(t.prev=this.tail,this.tail.next=t,this.tail=t):this.root=this.tail=t,this._size++}last(r=1){let t=this.tail;for(;--r&&t.prev;)t=t.prev;return t.data}}const Ut=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180];class rn{constructor(){this.p=[].concat(Ut,Ut)}grad(r,t,n,i){let s=15&r,o=s<8?t:n,l=s<4?n:s==12||s==14?t:i;return(1&s?-o:o)+(2&s?-l:l)}noise(r,t,n){let{p:i,grad:s}=this,[o,l,a]=[r,t,n].map(y=>255&Math.floor(y));[r,t,n]=[r,t,n].map(y=>y-Math.floor(y));let[u,c,h]=[r,t,n].map(y=>y*y*y*(y*(6*y-15)+10)),p=i[o]+l,f=i[p]+a,d=i[p+1]+a,m=i[o+1]+l,x=i[m]+a,g=i[m+1]+a;return U(h,U(c,U(u,s(i[f],r,t,n),s(i[x],r-1,t,n)),U(u,s(i[d],r,t-1,n),s(i[g],r-1,t-1,n))),U(c,U(u,s(i[f+1],r,t,n-1),s(i[x+1],r-1,t,n-1)),U(u,s(i[d+1],r,t-1,n-1),s(i[g+1],r-1,t-1,n-1))))}}function Ft(e,r){let t={},n=!0;for(let i=0;i<e.length;++i){let s=e[i],o=r[i];if(/=/.test(s)){let[l,a]=z(s,{symbol:"=",noSpace:!0});a!==void 0?(r.includes(l)&&(t[l]=a),n=!1):t[o]=s}else n&&(t[o]=s)}return t}const et=new Map,nn={π:Math.PI,gcd:(e,r)=>{for(;r;)[e,r]=[r,e%r];return e}},tt={"^":7,"*":6,"/":6,"÷":6,"%":6,"&":5,"|":5,"+":4,"-":4,"<":3,"<<":3,">":3,">>":3,"=":3,"==":3,"≤":3,"<=":3,"≥":3,">=":3,"≠":3,"!=":3,"∧":2,"&&":2,"∨":2,"||":2,"(":1,")":1};function Ne(e,r,t=[]){let n=[];for(;e.length;){let{name:i,value:s,type:o}=e.shift();if(o==="variable"){let l=r[s];Q(l)&&(l=Math[s]),Q(l)&&(l=Xt(s,r,t)),Q(l)&&/^\-\D/.test(s)&&(l=Xt("-1"+s.substr(1),r,t)),l===void 0&&(l=0),typeof l!="number"&&(t.push(l),qt(t)?(l=0,t=[]):l=Ne(oe(l),r,t)),n.push(l)}else if(o==="function"){let l=!1;/^\-/.test(i)&&(l=!0,i=i.substr(1));let a,u=s.map(h=>Ne(h,r,t)),c=i.split(".");for(;a=c.pop();){if(!a)continue;let h=r[a]||Math[a];u=typeof h=="function"?Array.isArray(u)?h(...u):h(u):0}l&&(u*=-1),n.push(u)}else if(/\d+/.test(s))n.push(s);else{let l=n.pop(),a=n.pop();n.push(sn(s,Number(a),Number(l)))}}return Number(n[0])||0}function oe(e){let r=function(i){if(et.has(i))return et.get(i);let s=String(i),o=[],l="";for(let a=0;a<s.length;++a){let u=s[a];if(tt[u]){let c=A(o);if(u=="="&&c&&/^[!<>=]$/.test(c.value))c.value+=u;else if(/^[|&<>]$/.test(u)&&c&&c.value==u)c.value+=u;else if(u=="-"&&s[a-1]=="e")l+=u;else if(o.length||l.length||!/[+-]/.test(u)){let{type:h,value:p}=c||{};h=="operator"&&!l.length&&/[^()]/.test(u)&&/[^()]/.test(p)?l+=u:(l.length&&(o.push({type:"number",value:l}),l=""),o.push({type:"operator",value:u}))}else l+=u}else/\S/.test(u)&&(u==","?(o.push({type:"number",value:l}),l="",o.push({type:"comma",value:u})):u=="!"?(o.push({type:"number",value:l}),o.push({type:"operator",value:u}),l=""):l+=u)}return l.length&&o.push({type:"number",value:l}),et.set(i,o),o}(e);const t=[],n=[];for(let i=0;i<r.length;++i){let{type:s,value:o}=r[i],l=r[i+1]||{};if(s=="number")if(l.value=="("&&/[^\d.\-]/.test(o)){let a="",u=[],c=[];for(i+=1;r[i++]!==void 0;){let h=r[i];if(h===void 0)break;let p=h.value;if(p==")"){if(!u.length)break;u.pop(),a+=p}else if(p=="("&&u.push(p),p!=","||u.length)a+=p;else{let f=oe(a);f.length&&c.push(f),a=""}}a.length&&c.push(oe(a)),n.push({type:"function",name:o,value:c})}else/[^\d.\-]/.test(o)?n.push({type:"variable",value:o}):n.push({type:"number",value:o});else if(s=="operator")if(o=="(")t.push(o);else if(o==")"){for(;t.length&&A(t)!="(";)n.push({type:"operator",value:t.pop()});t.pop()}else{for(;t.length&&tt[A(t)]>=tt[o];){let a=t.pop();/[()]/.test(a)||n.push({type:"operator",value:a})}t.push(o)}}for(;t.length;)n.push({type:"operator",value:t.pop()});return n}function sn(e,r,t){switch(e){case"+":return r+t;case"-":return r-t;case"*":return r*t;case"%":return r%t;case"|":return r|t;case"&":return r&t;case"<":return r<t;case">":return r>t;case"^":return Math.pow(r,t);case"÷":case"/":return r/t;case"=":case"==":return r==t;case"≤":case"<=":return r<=t;case"≥":case">=":return r>=t;case"≠":case"!=":return r!=t;case"∧":case"&&":return r&&t;case"∨":case"||":return r||t;case"<<":return r<<t;case">>":return r>>t}}function Xt(e,r,t){let[n,i,s]=e.match(/([\d.\-]+)(.*)/)||[],o=r[s];return o===void 0?o:typeof o=="number"?Number(i)*o:(t.push(o),qt(t)?(t=[],0):i*Ne(oe(o),r,t))}function qt(e){if(e.length>50)return!0;let r=A(e);for(let t=2;t<=4;++t){let n=e[e.length-t];if(n===void 0||r!==n)return!1}return!0}function F(e,r){return Ne(oe(e),Object.assign({},nn,r))}const C={name:"cssd-utime","animation-name":"cssd-utime-animation","animation-duration":31536e6,"animation-iteration-count":"infinite","animation-delay":"0s","animation-direction":"normal","animation-fill-mode":"none","animation-play-state":"running","animation-timing-function":"linear"};C.animation=`
 ${C["animation-duration"]}ms
 ${C["animation-timing-function"]} ${C["animation-delay"]} ${C["animation-iteration-count"]} ${C["animation-name"]}`;const rt="cssd-umousex",nt="cssd-umousey",it="cssd-uwidth",st="cssd-uheight";function Ee(e){let r=I(D(e)),t={},n={commands:[],valid:!0};for(;r.next();){let{curr:i}=r.get();if(!i.isSpace()&&!i.isSymbol(","))if(i.isWord())t.name&&(n.commands.push(t),t={}),t.name=i.value,t.value=[],"MmLlHhVvCcSsQqTtAaZz".includes(i.value)?"mlhvcsqtaz".includes(i.value)?t.type="relative":t.type="absolute":(t.type="unknown",n.valid=!1);else if(t.value){let s=i.value;i.isNumber()&&(s=Number(i.value)),t.value.push(s)}else t.name||(n.valid=!1)}return t.name&&n.commands.push(t),n}const ln=function(){let e=0;return(r="")=>`${r}-${++e}`}();class ae{constructor(r,t=""){if(!r)throw new Error("Tag name is required");this.id=Symbol(),this.name=r,this.body=[],this.attrs={},this.isTextNode()&&(this.body=t)}isTextNode(){return this.name==="text-node"}find(r){let t=r.attrs.id,n=r.name;if(Array.isArray(this.body)&&t!==void 0)return this.body.find(i=>i.attrs.id===t&&i.name===n)}findSpareDefs(){return this.body.find(r=>r.name==="defs"&&!r.attrs.id)}append(r){Array.isArray(r)||(r=[r]);for(let t of r)this.isTextNode()||this.body.push(t)}merge(r){for(let[t,n]of Object.entries(r.attrs))this.attrs[t]=n;Array.isArray(r.body)&&this.body.push(...r.body)}attr(r,t){if(!this.isTextNode())return t===void 0?this.attrs[r]:this.attrs[r]=t}toString(){if(this.isTextNode())return Ht(this.body);let r=[""],t=[];for(let[n,i]of Object.entries(this.attrs))i=Ht(i),r.push(`${n}="${i}"`);for(let n of this.body)t.push(n.toString());return t.join("").length||/svg/i.test(this.name)?`<${this.name}${r.join(" ")}>${t.join("")}</${this.name}>`:`<${this.name}${r.join(" ")}/>`}}function Ht(e){let r=(e=String(e)).startsWith('"')&&e.endsWith('"'),t=e.startsWith("'")&&e.endsWith("'");return r||t?e.substring(1,e.length-1):e}function lt(e,r,t,n){let i;if(r||(r=new ae("root")),e.type==="block")if(e.name==="style"){let o=new ae("style");o.append(e.value),r.append(o)}else{let o=new ae(e.name);if(n||(n=o).attr("xmlns",ie.split("=")[1]),e.name==="defs"){let h=n.findSpareDefs();h&&(o=h)}for(let h of e.value){e.parent=t;let p=lt(h,o,e,n);p&&(i=p)}let l=e&&e.inline&&e.name!=="defs",a=t&&t.inline&&t.name==="defs",u=a&&t.value.length==1;if(l||a){let h=e.value.find(p=>p.type==="statement"&&p.name==="id");h?i=h.value:(u||l)&&(i=ln(e.name),o.attr("id",i))}let c=r.find(o);if(c)c.merge(o);else if(e.name==="defs"){let h=n.findSpareDefs();h&&!o.attrs.id?o.id!==h.id&&h.append(o.body):n.append(o)}else r.append(o)}if(e.type==="statement"&&!e.variable)if(e.name==="content"){let o=new ae("text-node",e.value);r.append(o)}else if(e.name.startsWith("style ")){let o=(e.name.split("style ")[1]||"").trim();if(o.length){let l=r.attr("style")||"";r.attr("style",l+function(a,u){return`${a}:${u};`}(o,e.value))}}else{let o=e.value;if(o&&o.type==="block"){let l=lt(e.value,n,e,n);j(l)?o="":(o=`url(#${l})`,e.name!=="xlink:href"&&e.name!=="href"||(o=`#${l}`))}if(/viewBox/i.test(e.name))o=function(l){let a=l.detail.value,u=l.detail.padding||l.detail.p||l.detail.expand;if(!a.length)return"";let[c,h,p,f]=a;return u&&([c,h,p,f]=[c-u,h-u,p+2*u,f+2*u]),`${c} ${h} ${p} ${f}`}(e),o&&r.attr(e.name,o);else if(e.name!=="draw"&&e.name!=="animate"||(s=t&&t.name)!=="path"&&s!=="line"&&s!=="circle"&&s!=="ellipse"&&s!=="rect"&&s!=="polygon"&&s!=="polyline")r.attr(e.name,o);else{let[l,a]=String(o).split(/\s+/);(l==="indefinite"||l==="infinite"||/\d$/.test(l))&&([l,a]=[a,l]),a==="infinite"&&(a="indefinite"),r.attr("stroke-dasharray",10),r.attr("pathLength",10);let u=new ae("animate");u.attr("attributeName","stroke-dashoffset"),u.attr("from",10),u.attr("to",0),u.attr("dur",l),a&&u.attr("repeatCount",a),r.append(u)}e.name.includes("xlink:")&&n.attr("xmlns:xlink",Ke.split("=")[1])}var s;return t?i:n.toString()}function Te(e){return lt(e)}const on=["auto","reverse"],an=["deg","rad","grad","turn"];function un(e){let r=I(D(e)),t=!1,n="",i={direction:"",angle:""};for(;r.next();){let{prev:s,curr:o,next:l}=r.get();if(o.isWord()&&on.includes(o.value))i.direction=o.value,t=!0;else if(o.isNumber())i.angle=Number(o.value),t=!0;else if(o.isWord()&&s&&s.isNumber()&&an.includes(o.value))n=o.value;else if(o.isSpace()&&i.direction!==""&&i.angle!=="")break}return t||(i.direction="auto"),function(s,o){let{angle:l}=s;return l===""&&(l=0),o==="rad"&&(l/=Math.PI/180),o==="grad"&&(l*=.9),o==="turn"&&(l*=360),Object.assign({},s,{angle:l})}(i,n)}function Yt(e,r,t){return["fill-rule","fill"].includes(e)?r:t?`-1 * (${r})`:r}function ot(e){return e.map(r=>r.value).join("")}const{cos:ue,sin:ce,abs:cn,atan2:Gt,PI:at}=Math,ut={circle:`
 split:180;scale:.99
 `,triangle:`
 rotate:30;scale:1.1;move:0 .2
 `,pentagon:`
 split:5;rotate:54
 `,hexagon:`
 split:6;rotate:30;scale:.98
 `,octagon:`
 split:8;rotat:22.5;scale:.99
 `,star:`
 split:10;r:cos(5t);rotate:-18;scale:.99
 `,infinity:`
 split:180;scale:.99;x:cos(t)*.99 / (sin(t)^2 + 1);y:x * sin(t)
 `,heart:`
 split:180;rotate:180;a:cos(t)*13/18 - cos(2t)*5/18;b:cos(3t)/18 + cos(4t)/18;x:(.75 * sin(t)^3) * 1.2;y:(a - b + .2) * -1.1
 `,bean:`
 split:180;r:sin(t)^3 + cos(t)^3;move:-.35 .35;`,bicorn:`
 split:180;x:cos(t);y:sin(t)^2 / (2 + sin(t)) - .5
 `,drop:`
 split:180;rotate:90;scale:.95;x:sin(t);y:(1 + sin(t)) * cos(t) / 1.6
 `,fish:`
 split:240;x:cos(t) - sin(t)^2 / sqrt(2) - .04;y:sin(2t)/2
 `,whale:`
 split:240;rotate:180;R:3.4 * (sin(t)^2 - .5) * cos(t);x:cos(t) * R + .75;y:sin(t) * R * 1.2
 `,windmill:`
 split:18;R:seq(.618, 1, 0);T:seq(t-.55, t, t);x:R * cos(T);y:R * sin(T)
 `,vase:`
 split:240;scale:.3;x:sin(4t) + sin(t) * 1.4;y:cos(t) + cos(t) * 4.8 + .3
 `,clover:(e=3)=>((e=L(e,3,5))==4&&(e=2),`
 split:240;r:cos(${e}t);scale:.98
`),hypocycloid:(e=3)=>`
 split:240;scale:${[.34,.25,.19][(e=L(e,3,5))-3]};k:${e};x:(k-1)*cos(t) + cos((k-1)*t);y:(k-1)*sin(t) - sin((k-1)*t)
`,bud:(e=3)=>`
 split:240;scale:.8;r:1 + .2 * cos(${e=L(e,3,10)}t)
`};class Vt{constructor(r,t,n){this.x=r,this.y=t,this.extra=n}valueOf(){return this.x+" "+this.y}toString(){return this.valueOf()}}function hn(e,r){r||(r=d=>[ue(d),ce(d)]);let t,n,i=e.split||180,s=e.turn||1,o=e.frame,l=e.fill||e["fill-rule"],a=un(e.direction||e.dir||""),u=e.unit,c=2*at*s/i,h=[],p=e.scale===void 0?1:e.scale,f=([d,m,x=0,g=0])=>{if(d=="evenodd"||d=="nonzero")return h.push(new Vt(d,"",""));let[y,v]=Zt(d,-m,p),[_,b]=Zt(x,-g,p),w=function(S,k,R,N,O){let M=180*Gt(k+N,S-R)/at;return O.direction==="reverse"&&(M-=180),O.direction||(M=90),O.angle&&(M+=O.angle),M}(y,v,_,b,a);u!==void 0&&u!=="%"?u!=="none"&&(y+=u,v+=u):(y=50*(y+1)+"%",v=50*(v+1)+"%"),h.push(new Vt(y,v,w))};l!="nonzero"&&l!="evenodd"||f([l,"",""]);for(let d=0;d<i;++d){let m=r(c*d,d);d||(t=m),f(m)}if(o!==void 0){f(t);let d=o/100;s>1&&(d*=2),d==0&&(d=.002);for(let m=0;m<i;++m){let x=-c*m,[g,y,v=0,_=0]=r(x,m),b=Gt(y+_,g-v),w=[g-d*ue(b),y-d*ce(b)];m||(n=w),f(w)}f(n),f(t)}return h}function Zt(e,r,t){let[n,i=n]=z(t).map(Number);return[e*n,r*i]}function pn(e,{min:r,max:t}){let n=L(parseInt(e.vertices||e.points||e.split)||0,r,t),i=B(e.x)?"cos(t)":e.x,s=B(e.y)?"sin(t)":e.y,o=B(e.r)?"":e.r,l=B(e.t)?"":e.t,{unit:a,value:u}=se(o);return a&&!e[a]&&a!=="t"&&(B(e.unit)&&(e.unit=a),o=e.r=u),e.degree&&(e.rotate=e.degree),e.origin&&(e.move=e.origin),e.split=n,hn(e,(c,h)=>{let p=Object.assign({},e,{t:l||c,θ:l||c,i:h+1,seq:(...g)=>g.length?g[h%g.length]:"",range:(g,y=0)=>((g=Number(g)||0)>(y=Number(y)||0)&&([g,y]=[y,g]),g+cn(y-g)/(n-1)*h)}),f=F(i,p),d=F(s,p),m=0,x=0;if(o){let g=F(o,p);g==0&&(g=1e-5),l&&(c=F(l,p)),f=g*ue(c),d=g*ce(c)}return e.rotate&&([f,d]=function(g,y,v){let _=-at/180*v;return[g*ue(_)-y*ce(_),y*ue(_)+g*ce(_)]}(f,d,Number(e.rotate)||0)),e.move&&([f,d,m,x]=function(g,y,v){let[_,b=_]=z(v).map(Number);return[g+(_||0),y-(b||0),_,b]}(f,d,e.move)),[f,d,m,x]})}function he(e,r=3,t=3600,n){let i="",[s,...o]=z(e),l=!1;switch(typeof ut[s]){case"function":i=ut[s](...o),l=!0;break;case"string":i=ut[s],l=!0;break;default:i=e}let a=function(u){let c,h=I(D(u)),p={},f=[],d=!1;for(;h.next();){let{prev:m,curr:x,next:g}=h.get();if(x.isSymbol(":")&&!c)c=ot(f),f=[];else if(x.isSymbol(";")&&c)p[c]=Yt(c,ot(f),d),f=[],c=null,d=!1;else if(!x.isSymbol(";")){let y=m&&m.isSymbol("-"),v=g&&g.isSymbol("-"),_=x.isSymbol("-");c||f.length||!_||y||v||g&&g.isSymbol(":")?f.push(x):d=!0}}return f.length&&c&&(p[c]=Yt(c,ot(f),d)),p}(i);return typeof n=="function"&&(a=n(a)),{rules:a,points:pn(a,{min:r,max:t}),preset:l}}function ct(e){return V((r,t,...n)=>{if(!n||!t)return"";let i=E(t()),s=i;/\D/.test(i)&&!/\d+[x-]\d+/.test(i)&&(s=F(i),s===0&&(s=i));let o=Math.random();return function(l,a){let[u,c=1]=String(l).split(/[x-]/),[h,p]=[Math.ceil(u),Math.ceil(c)];Q(h)&&(h=1),Q(p)&&(p=1),u=L(h,0,65536),c=L(p,0,65536);let f=u*c,d=[],m=1;if(/x/.test(l))for(let x=1;x<=c;++x)for(let g=1;g<=u;++g)d.push(a(m,g,x,f,u,c,m)),m++;else if(/-/.test(l))if(f=Math.abs(u-c)+1,u<=c)for(let x=u;x<=c;++x)d.push(a(x,x,1,f,f,1,m++));else for(let x=u;x>=c;--x)d.push(a(x,x,1,f,f,1,m++));else for(let x=1;x<=u;++x)d.push(a(x,x,1,u,u,1,m++));return d}(s,(...l)=>n.map(a=>E(a(...l,o))).join(",")).join(e)})}function Y(e,r,t){return e[r]||(e[r]=new tn(1024)),e[r].push(t),t}function Kt(e){return-1*e}function Jt(e,r,t){switch(e){case"+":return r+t;case"-":return r-t;case"*":return r*t;case"/":return r/t;case"%":return r%t;default:return 0}}function T(e){return r=>{if(B(r)||B(e))return e;if(/^[\+\*\-\/%][\-\.\d\s]/.test(r)){let t=r[0],{unit:n="",value:i}=se(r.substr(1).trim()||0);return/^var/.test(e)?`calc((${e} ${t} ${i}) * 1${n})`:Jt(t,e,i)+n}if(/[\+\*\-\/%]$/.test(r)){let t=r.substr(-1),{unit:n="",value:i}=se(r.substr(0,r.length-1).trim()||0);return/^var/.test(e)?`calc((${i} ${t} ${e}) * 1${n})`:Jt(t,i,e)+n}{let{unit:t="",value:n}=se(r||0);return e+n+t}}}const Re=Le({i:({count:e})=>T(e),y:({y:e})=>T(e),x:({x:e})=>T(e),z:({z:e})=>T(e),I:({grid:e})=>T(e.count),Y:({grid:e})=>T(e.y),X:({grid:e})=>T(e.x),Z:({grid:e})=>T(e.z),iI:({count:e,grid:r})=>T(e/r.count),id:({x:e,y:r,z:t})=>n=>ee(e,r,t),dx:({x:e,grid:r})=>t=>(t=Number(t)||0,e-.5-t-r.x/2),dy:({y:e,grid:r})=>t=>(t=Number(t)||0,e-.5-t-r.y/2),n({extra:e}){let r=A(e);return r?T(r[0]):"@n"},nx({extra:e}){let r=A(e);return r?T(r[1]):"@nx"},ny({extra:e}){let r=A(e);return r?T(r[2]):"@ny"},N({extra:e}){let r=A(e);return r?T(r[3]):"@N"},nN({extra:e}){let r=A(e);return r?T(r[0]/r[3]):"@nN"},m:ct(","),M:ct(" "),µ:ct(""),p:({context:e,pick:r})=>le((...t)=>{t.length||(t=e.last_pick_args||[]);let n=r(t);return e.last_pick_args=t,Y(e,"last_pick",n)}),P({context:e,pick:r,position:t}){let n="P-counter"+t;return le((...i)=>{let s=!0;i.length||(i=e.last_pick_args||[],s=!1);let o=e.last_pick,l=o?o.last(1):"";if(s&&(e[n]||(e[n]={}),l=e[n].last_pick),i.length>1){let u=i.findIndex(c=>c===l);u!==-1&&i.splice(u,1)}let a=r(i);return e.last_pick_args=i,s&&(e[n].last_pick=a),Y(e,"last_pick",a)})},pl({context:e,extra:r,position:t}){let n=A(r),i="pl-counter"+t+(n?A(n):"");return le((...s)=>{e[i]||(e[i]=0),e[i]+=1;let o=s.length,l=n&&n[6];j(l)&&(l=e[i]);let a=s[(l-1)%o];return Y(e,"last_pick",a)})},pr({context:e,extra:r,position:t}){let n=A(r),i="pr-counter"+t+(n?A(n):"");return le((...s)=>{e[i]||(e[i]=0),e[i]+=1;let o=s.length,l=n&&n[6];j(l)&&(l=e[i]);let a=s[o-(l-1)%o-1];return Y(e,"last_pick",a)})},pd({context:e,extra:r,position:t,shuffle:n}){let i=A(r),s=i?A(i):"",o="pd-counter"+t+s,l="pd-values"+t+s;return le((...a)=>{e[o]||(e[o]=0),e[o]+=1,e[l]||(e[l]=n(a||[]));let u=a.length,c=i&&i[6];j(c)&&(c=e[o]);let h=(c-1)%u,p=e[l][h];return Y(e,"last_pick",p)})},lp:({context:e})=>(r=1)=>{let t=e.last_pick;return t?t.last(r):""},r:({context:e,rand:r})=>(...t)=>{let n=(t.every(De)?Je:Bt)(r)(...t);return Y(e,"last_rand",n)},rn({x:e,y:r,context:t,position:n,grid:i,extra:s,random:o}){let l="noise-2d"+n,a=l+"offset-x",u=l+"offset-y",[c,h,p,f,d,m]=A(s)||[],x=c&&f;return(...g)=>{let{from:y=0,to:v=y,frequency:_=1,scale:b=1,octave:w=1}=Ft(g,["from","to","frequency","scale","octave"]);_=L(_,0,1/0),b=L(b,0,1/0),w=L(w,1,100),g.length==1&&([y,v]=[0,y]),t[l]||(t[l]=new rn),t[a]||(t[a]=o()),t[u]||(t[u]=o());let S=De(y)&&De(v)?Je:Bt,k=t[l],R=t[a],N=t[u],O=(x?(h-1)/d:(e-1)/i.x)+R,M=(x?(p-1)/m:(r-1)/i.y)+N;(d<=1||i.x<=1)&&(O=0),(m<=1||i.y<=1)&&(M=0),O==0&&M==0&&(O=R,M=N);let $r=k.noise(O*_,M*_,0)*b;for(let me=1;me<w;++me){let ge=2*me;$r+=k.noise(O*_*ge,M*_*ge,0)*(b/ge)}let En=S((me,ge)=>function(Tn,Rn,zn,vt=1){let wr=Math.sqrt(.5)*vt,[kr,Cn]=[-wr,wr];return U((Tn-kr)/(Cn-kr),Rn*vt,zn*vt)}($r,me,ge,b));return Y(t,"last_rand",En(y,v))}},lr:({context:e})=>(r=1)=>{let t=e.last_rand;return t?t.last(r):""},stripe:()=>(...e)=>{let r,t=e.map(E),n=t.length,i=0,s=[];if(!n)return"";t.forEach(l=>{let[a,u]=z(l);u!==void 0?s.push(u):i+=1});let o=s.length?`(100% - ${s.join(" - ")}) / ${i}`:`100% / ${n}`;return t.map((l,a)=>{if(s.length){let[u,c]=z(l);return r=(r?r+" + ":"")+(c!==void 0?c:o),`${u} 0 calc(${r})`}return`${l} 0 ${100/n*(a+1)}%`}).join(",")},calc:()=>(e,r)=>F(E(e),r),hex:()=>e=>parseInt(E(e)).toString(16),svg:V((e,...r)=>{let t=r.map(n=>E(n())).join(",");return t.startsWith("<")||(t=Te(re(t))),je(Dt(t))}),"svg-filter":V((e,...r)=>{let t=r.map(s=>E(s())),n=t.join(","),i=ye("filter-");if(t.every(s=>/^[\-\d.]/.test(s)||/^(\w+)/.test(s)&&!/[{}<>]/.test(s))){let{frequency:s,scale:o,octave:l,seed:a=e.seed,blur:u,erode:c,dilate:h}=Ft(t,["frequency","scale","octave","seed","blur","erode","dilate"]);if(n=`
 x:-20%;y:-20%;width:140%;height:140%;`,j(h)||(n+=`
 feMorphology{operator:dilate;radius:${h};}`),j(c)||(n+=`
 feMorphology{operator:erode;radius:${c};}`),j(u)||(n+=`
 feGaussianBlur{stdDeviation:${u};}`),!j(s)){let[p,f=p]=z(s);l=l?`numOctaves:${l};`:"",n+=`
 feTurbulence{type:fractalNoise;baseFrequency:${p} ${f};seed:${a};${l}}`,o&&(n+=`
 feDisplacementMap{in:SourceGraphic;scale:${o};}`)}}return n.startsWith("<")||(n=Te(re(n,{type:"block",name:"filter"}))),je(Dt(n).replace(/<filter([\s>])/,`<filter id="${i}"$1`),i)}),"svg-pattern":V((e,...r)=>je(Te(re(`
 viewBox:0 0 1 1;preserveAspectRatio:xMidYMid slice;rect{width, height:100%;fill:defs pattern{${r.map(t=>E(t())).join(",")}}}`)))),"svg-polygon":V((e,...r)=>{let t=r.map(l=>E(l())).join(","),{rules:n,points:i}=he(t,3,65536,l=>(delete l.frame,l.unit="none",l["stroke-width"]??=.01,l.stroke??="currentColor",l.fill??="none",l)),s=`points:${i};`,o="";for(let l of Object.keys(n))/^(stroke|fill|clip|marker|mask|animate|draw)/.test(l)&&(o+=`${l}:${n[l]};`);return je(Te(re(`
 viewBox:-1 -1 2 2 p ${Number(n["stroke-width"])/2};polygon{${o} ${s}}`)))}),var:()=>e=>`var(${E(e)})`,ut:()=>T(`var(--${C.name})`),uw:()=>T(`var(--${it})`),uh:()=>T(`var(--${st})`),ux:()=>T(`var(--${rt})`),uy:()=>T(`var(--${nt})`),plot({count:e,context:r,extra:t,position:n,grid:i}){let s="offset-points"+n,o=A(t);return(...l)=>{let a=l.join(","),[u=e,c,h,p=i.count]=o||[];if(!r[s]){let{points:f}=he(a,1,65536,d=>(delete d.fill,delete d["fill-rule"],delete d.frame,d.points=p,d));r[s]=f}return r[s][u-1]}},Plot({count:e,context:r,extra:t,position:n,grid:i}){let s="Offset-points"+n,o=A(t);return(...l)=>{let a=l.join(","),[u=e,c,h,p=i.count]=o||[];if(!r[s]){let{points:f}=he(a,1,65536,d=>(delete d.fill,delete d["fill-rule"],delete d.frame,d.points=p,d.unit=d.unit||"none",d));r[s]=f}return r[s][u-1]}},shape:()=>Qe("shape-function",(...e)=>{let r=e.join(","),{points:t}=he(r);return`polygon(${t.join(",")})`}),doodle:()=>e=>e,shaders:()=>e=>e,pattern:()=>e=>e,invert:()=>e=>{let r=Ee(e);return r.valid?r.commands.map(({name:t,value:n})=>{switch(t){case"v":return"h"+n.join(" ");case"V":return"H"+n.join(" ");case"h":return"v"+n.join(" ");case"H":return"V"+n.join(" ");default:return t+n.join(" ")}}).join(" "):e},flipH:()=>e=>{let r=Ee(e);return r.valid?r.commands.map(({name:t,value:n})=>{switch(t){case"h":case"H":return t+n.map(Kt).join(" ");default:return t+n.join(" ")}}).join(" "):e},flipV:()=>e=>{let r=Ee(e);return r.valid?r.commands.map(({name:t,value:n})=>{switch(t){case"v":case"V":return t+n.map(Kt).join(" ");default:return t+n.join(" ")}}).join(" "):e},flip(...e){let r=Re.flipH(...e),t=Re.flipV(...e);return n=>t(r(n))},reverse:()=>(...e)=>{let r=e.map(E),t=Ee(r.join(","));if(t.valid){let n=[];for(let i=t.commands.length-1;i>=0;--i){let{name:s,value:o}=t.commands[i];n.push(s+o.join(" "))}return n.join(" ")}return r.reverse()},cycle:()=>(...e)=>{let r,t=[];(e=e.map(s=>"<"+s+">")).length==1?(r=" ",t=z(e[0],{symbol:r})):(r=",",t=z(e.map(E).join(r),{symbol:r})),t=t.map(s=>s.replace(/^\<|>$/g,""));let n=t.length-1,i=[t.join(r)];for(let s=0;s<n;++s){let o=t.shift();t.push(o),i.push(t.join(r))}return i},mirror:()=>(...e)=>{for(let r=e.length-1;r>=0;--r)e.push(e[r]);return e},Mirror:()=>(...e)=>{for(let r=e.length-2;r>=0;--r)e.push(e[r]);return e},code:()=>(...e)=>e.map(r=>String.fromCharCode(r)),once:V(({context:e,extra:r,position:t},...n)=>{let i="once-counter"+t;return j(e[i])?e[i]=n.map(s=>E(s())).join(","):e[i]}),raw:({rules:e})=>(r="")=>{try{let t=r.substring(r.indexOf(",")+1,r.lastIndexOf('")'));if(r.startsWith("${doodle")&&r.endsWith("}")){let n=r.substring(2,r.length-1),i=e.doodles;if(i&&i[n])return`<css-doodle>${i[n].doodle}</css-doodle>`}if(r.startsWith('url("data:image/svg+xml;utf8'))return decodeURIComponent(t);if(r.startsWith('url("data:image/svg+xml;base64'))return atob(t);if(r.startsWith('url("data:image/png;base64'))return`<img src="${r}" alt="" />`}catch{}return r}},{index:"i",col:"x",row:"y",depth:"z",rand:"r",pick:"p",pn:"pl",pnr:"pr",stripes:"stripe",strip:"stripe",patern:"pattern",flipv:"flipV",fliph:"flipH",t:"ut",filter:"svg-filter","last-rand":"lr","last-pick":"lp",multiple:"m",multi:"m",rep:"µ",repeat:"µ",ms:"M",s:"I",size:"I",sx:"X","size-x":"X","size-col":"X","max-col":"X",sy:"Y","size-y":"Y","size-row":"Y","max-row":"Y",sz:"Z","size-z":"Z","size-depth":"Z",Svg:"svg","pick-by-turn":"pl","pick-n":"pl","pick-d":"pd",offset:"plot",Offset:"Plot",point:"plot",Point:"Plot",unicode:"code"}),Qt={a0:[841,1189],a1:[594,841],a2:[420,594],a3:[297,420],a4:[210,297],a5:[148,210],a6:[105,148],b0:[1e3,1414],b1:[707,1e3],b2:[500,707],b3:[353,500],b4:[250,353],b5:[176,250],b6:[125,176],c0:[917,1297],c1:[648,917],c2:[458,648],c3:[324,458],c4:[229,324],c5:[162,229],d0:[764,1064],d1:[532,760],d2:[380,528],d3:[264,376],d4:[188,260],d5:[130,184],d6:[92,126],letter:[216,279],postcard:[100,148],poster:[390,540]},fn={portrait:"p",pt:"p",p:"p",landscape:"l",ls:"l",l:"l"};let ze=[];function er(e){let r=new RegExp(`\\-?${e}\\-?`);return function(t){if(!ze.length){let n=new Set;if(typeof document<"u")for(let i in document.head.style)i.startsWith("-")||n.add(i.replace(/[A-Z]/g,"-$&").toLowerCase());n.has("grid-gap")||n.add("grid-gap"),ze=Array.from(n)}return t instanceof RegExp?ze.filter(n=>t.test(n)):ze}(r).map(t=>t.replace(r,"")).reduce((t,n)=>(t[n]=n,t),{})}const dn=er("webkit"),mn=er("moz");function tr(e,r){return dn[e]?`-webkit-${r} ${r}`:mn[e]?`-moz-${r} ${r}`:r}const rr="--_cell-width",nr="--_cell-height",gn={center:"50%",left:"0%",right:"100%",top:"50%",bottom:"50%"},vn={center:"50%",top:"0%",bottom:"100%",left:"50%",right:"50%"};var Ce=Le({size(e,{is_special_selector:r,grid:t}){let[n,i=n,s]=z(e);Qt[n]&&([n,i]=function(l,a){l=String(l).toLowerCase();let[u,c]=Qt[l]||[];return fn[a]=="p"&&([c,u]=[u,c]),[c,u].map(h=>h+"mm")}(n,i));let o=`width:${n};height:${i};`;return n!=="auto"&&i!=="auto"||(s&&(/^\(.+\)$/.test(s)?s=s.substring(1,s.length-1):/^calc/.test(s)||(s=`calc(${s})`),r||(o+=`aspect-ratio:${s};`)),r&&(o+=`aspect-ratio:${s||t.ratio};`)),r||(o+=`${rr}:${n};${nr}:${i};`),o},place(e,{extra:r}){let[t,n="50%"]=z(e);t=gn[t]||t,n=vn[n]||n;let i=`var(${rr}, 25%)`,s=`var(${nr}, 25%)`;return`
 position:absolute;left:${t};top:${n};width:${i};height:${s};margin-left:calc(${i} / -2);margin-top:calc(${s} / -2);grid-area:unset;--plot-angle:${r||0};rotate:${r||0}deg;`},grid(e,r){let t={clip:!0};/no\-*clip/i.test(e)&&(t.clip=!1,e=e.replace(/no\-*clip/i,""));let n=z(e,{symbol:["/","+","^","*","|","-","~","∆"],noSpace:!0,verbose:!0});for(let{group:i,value:s}of n)i==="+"&&(t.scale=s),i==="^"&&(t.enlarge=s),i==="*"&&(t.rotate=s),i==="~"&&(t.translate=s),i==="∆"&&(t.persp=z(s,{symbol:" "})),i==="/"&&(t.size===void 0?t.size=this.size(s,r):t.fill=s),i!=="|"&&i!="-"&&i!=""||t.grid||(t.grid=ne(s,r.max_grid),i==="|"&&(t.flexCol=!0),i==="-"&&(t.flexRow=!0));return t},gap:e=>e,seed:e=>e,shape:Qe("shape-property",e=>{let{points:r,preset:t}=he(e);if(!t)return"";let n="clip-path";return tr(n,`${n}:polygon(${r.join(",")});`)}),use(e){if(e.length>2)return e},content:e=>e},{"place-cell":"place",offset:"place",position:"place"});function ir(e,r){return r==="+"?e:r==="-"?-1*e:e}function sr(e){return e.reduce((r,t)=>r+t,0)}function ht(e){return e%2}function lr(e){return!ht(e)}function pt(e){let r="";return r=e==0?"$:hover":e>0?`$:hover ${"+*".repeat(e)}`:`:has(+ ${"*+".repeat(Math.abs(e+1))} $:hover)`,r}function ft(e,r){if(e==="even")return lr(r);if(e==="odd")return ht(r);if(e=="n")return!0;let{a:t,b:n,error:i}=function(s){let o,l,a=I(D(s)),u=[],c=[];for(;a.next();){let{prev:h,curr:p,next:f}=a.get(),d=p.value;if(p.isSymbol()){if(d!=="+"&&d!=="-"){l="Unexpected "+p.value;break}o=d}else if(p.isNumber()){if((u.length||c.length)&&!o){l="Syntax error";break}if(d=ir(Number(d),o),o=null,f&&f.value==="n"){u.push(d),a.next();continue}c.push(d)}else if(d==="n"){if((u.length||c.length)&&!o){l="Syntax error";break}u.push(ir(1,o)),o=null}else if(!p.isSpace()){l="Unexpected "+d;break}}return l?{a:0,b:0,error:l}:{a:sr(u),b:sr(c)}}(e);if(i)return!1;if(t===0)return r===n;{let s=(r-n)/t;return s>=0&&Number.isInteger(s)}}var or,yn=Le({at:({x:e,y:r})=>(t,n)=>e==t&&r==n,nth:({count:e,grid:r})=>(...t)=>{for(let n of t)if(ft(n,e))return!0},y:({y:e,grid:r})=>(...t)=>{for(let n of t)if(ft(n,e))return!0},x:({x:e,grid:r})=>(...t)=>{for(let n of t)if(ft(n,e))return!0},even:({x:e,y:r})=>t=>ht(e+r),odd:({x:e,y:r})=>t=>lr(e+r),random:({random:e,count:r,x:t,y:n,grid:i})=>(s=.5)=>/\D/.test(s)?e()<F("("+s+")",{x:t,X:i.x,y:n,Y:i.y,i:r,I:i.count,random:e}):e()<s,match:({count:e,grid:r,x:t,y:n,random:i})=>s=>!!F("("+s+")",{x:t,X:r.x,y:n,Y:r.y,i:e,I:r.count,random:i}),hover:({count:e,x:r,y:t,grid:n,random:i})=>(...s)=>{let o=[];s.length||o.push(pt(0));for(let l of s){let[a,u]=String(l).split(/\s+/);if(a=Number(a),u=Number(u),Number.isNaN(u)&&!Number.isNaN(a)&&o.push(pt(a)),!Number.isNaN(a)&&!Number.isNaN(u)){let c=a+r,h=u+t;if(c>=1&&c<=n.x&&h>=1&&h<=n.y){let p=u*n.y+a;o.push(pt(p))}}}return!!o.length&&{selector:o.join(",")}}},{col:"x",row:"y"}),pe=globalThis,fe=Math,Me=[],X=256,ar=6,bn="random",xn=fe.pow(X,ar),ur=fe.pow(2,52),_n=2*ur,G=X-1;function Pe(e,r,t){var n=[],i=dt(hr((r=r==1?{entropy:!0}:r||{}).entropy?[e,de(Me)]:e??function(){try{var l;return or&&(l=or.randomBytes)||(l=new Uint8Array(X),(pe.crypto||pe.msCrypto).getRandomValues(l)),de(l)}catch{var a=pe.navigator,u=a&&a.plugins;return[+new Date,pe,u,pe.screen,de(Me)]}}(),3),n),s=new $n(n),o=function(){for(var l=s.g(ar),a=xn,u=0;l<ur;)l=(l+u)*X,a*=X,u=s.g(1);for(;l>=_n;)l/=2,a/=2,u>>>=1;return(l+u)/a};return o.int32=function(){return 0|s.g(4)},o.quick=function(){return s.g(4)/4294967296},o.double=o,dt(de(s.S),Me),(r.pass||t||function(l,a,u,c){return c&&(c.S&&cr(c,s),l.state=function(){return cr(s,{})}),u?(fe[bn]=l,a):l})(o,i,"global"in r?r.global:this==fe,r.state)}function $n(e){var r,t=e.length,n=this,i=0,s=n.i=n.j=0,o=n.S=[];for(t||(e=[t++]);i<X;)o[i]=i++;for(i=0;i<X;i++)o[i]=o[s=G&s+e[i%t]+(r=o[i])],o[s]=r;(n.g=function(l){for(var a,u=0,c=n.i,h=n.j,p=n.S;l--;)a=p[c=G&c+1],u=u*X+p[G&(p[c]=p[h=G&h+a])+(p[h]=a)];return n.i=c,n.j=h,u})(X)}function cr(e,r){return r.i=e.i,r.j=e.j,r.S=e.S.slice(),r}function hr(e,r){var t,n=[],i=typeof e;if(r&&i=="object")for(t in e)try{n.push(hr(e[t],r-1))}catch{}return n.length?n:i=="string"?e:e+"\0"}function dt(e,r){for(var t,n=e+"",i=0;i<n.length;)r[G&i]=G&(t^=19*r[G&i])+n.charCodeAt(i++);return de(r)}function de(e){return String.fromCharCode.apply(0,e)}function q(e){return/^\:(host|doodle)/.test(e)}function Oe(e){return/^\:(container|parent)/.test(e)}function mt(e){return q(e)||Oe(e)}dt(fe.random(),Me);const pr={};for(let e of Object.getOwnPropertyNames(Math))pr[e]=()=>(...r)=>typeof Math[e]=="number"?Math[e]:(r=r.map(t=>F(E(t))),Math[e](...r));class wn{constructor(r){this.tokens=r,this.rules={},this.props={},this.keyframes={},this.grid=null,this.seed=null,this.is_grid_set=!1,this.is_gap_set=!1,this.coords=[],this.doodles={},this.pattern={},this.shaders={},this.vars={},this.uniforms={},this.content={},this.reset()}reset(){this.styles={host:"",container:"",cells:"",keyframes:""},this.coords=[],this.doodles={},this.pattern={},this.shaders={},this.content={};for(let r in this.rules)r.startsWith("#c")&&delete this.rules[r]}add_rule(r,t){let n=this.rules[r];n||(n=this.rules[r]=[]),n.push.apply(n,be(t))}pick_func(r){return r.startsWith("$")&&(r="calc"),Re[r]||pr[r]}apply_func(r,t,n,i,s={}){let o=r(...be(t)),l=[];if(n.forEach(a=>{let u=typeof a.value;if(a.cluster||u!=="number"&&u!=="string"){if(typeof a=="function")l.push(a);else if(!j(a.value)){let c=E(a.value);l.push(c)}}else l.push(...z(a.value,{noSpace:!0}))}),l=be(l.filter(a=>!j(a)&&String(a).trim().length)),typeof o=="function"){if(i.startsWith("$")){let a=Object.assign({},this.vars.host,this.vars.container,this.vars[t.count],s),u={},c="";for(let[h,p]of Object.entries(a))u[h.substr(2)]=p;return i.length>1&&(c=i.split("$")[1]??""),o(l,u)+c}return o(...l)}return o}compose_aname(...r){return r.join("-")}compose_selector({x:r,y:t,z:n},i=""){return`#${ee(r,t,n)}${i}`}is_composable(r){return["doodle","shaders","pattern"].includes(r)}read_var(r,t,n){let i=t.count,s=Object.assign({},this.vars.host,this.vars.container,this.vars[i],n);if(s[r]!==void 0){let o=String(s[r]).trim();return o[0]=="("&&o[o.length-1]===")"&&(o=o.substring(1,o.length-1)),o.replace(/;+$/g,"")}return r}compose_argument(r,t,n=[],i,s){t.extra||(t.extra=[]),t.extra.push(n);let o=r.map(l=>{if(l.type==="text")return/^\-\-\w/.test(l.value)?i&&i.name==="@var"?l.value:this.read_var(l.value,t,s):l.value;if(l.type==="func"){let a=l.name.substr(1),u=this.pick_func(a);if(typeof u=="function"){if(this.check_uniforms(a),this.is_composable(a)){let h,p=E((l.arguments[0]||[])[0]);if(a==="doodle"&&/^\d/.test(p)&&(h=p,p=E((l.arguments[1]||[])[0])),!j(p))switch(a){case"doodle":return this.compose_doodle(this.inject_variables(p,t.count),h);case"shaders":return this.compose_shaders(p,t);case"pattern":return this.compose_pattern(p,t)}}t.position=l.position;let c=l.arguments.map(h=>u.lazy?(...p)=>this.compose_argument(h,t,p,l,s):this.compose_argument(h,t,n,l,s));return this.apply_func(u,t,c,a,s)}return l.name}});return t.extra.pop(),{cluster:r.cluster,value:o.length>=2?{value:o.join("")}:o[0]}}compose_doodle(r,t){let n=ye("doodle");return this.doodles[n]={doodle:r,arg:t},"${"+n+"}"}compose_shaders(r,{x:t,y:n,z:i}){let s=ye("shader");return this.shaders[s]={shader:r,id:"--"+s,cell:ee(t,n,i)},"${"+s+"}"}compose_pattern(r,{x:t,y:n,z:i}){let s=ye("pattern");return this.pattern[s]={code:r,id:"--"+s,cell:ee(t,n,i)},"${"+s+"}"}check_uniforms(r){switch(r){case"ut":case"t":this.uniforms.time=!0;break;case"ux":this.uniforms.mousex=!0;break;case"uy":this.uniforms.mousey=!0;break;case"uw":this.uniforms.width=!0;break;case"uh":this.uniforms.height=!0}}inject_variables(r,t){let n=Object.assign({},this.vars.host,this.vars.container,this.vars[t]),i=[];for(let[s,o]of Object.entries(n))i.push(`${s}:${o};`);return i=i.join(""),i.length?`:doodle{${i}}`+r:r}compose_variables(r,t,n={}){for(let[i,s]of Object.entries(r))n[i]=this.get_composed_value(s,t,n).value;return n}compose_value(r,t,n={}){if(!Array.isArray(r))return{value:"",extra:""};let i="";return{value:r.reduce((o,l)=>{switch(l.type){case"text":o+=l.value;break;case"func":{let a=l.name.substr(1),u=this.pick_func(a);if(typeof u=="function")if(this.check_uniforms(a),this.is_composable(a)){let c,h=E((l.arguments[0]||[])[0]);if(a==="doodle"&&/^\d/.test(h)&&(c=h,h=E((l.arguments[1]||[])[0])),!j(h))switch(a){case"doodle":o+=this.compose_doodle(this.inject_variables(h,t.count),c);break;case"shaders":o+=this.compose_shaders(h,t);break;case"pattern":o+=this.compose_pattern(h,t)}}else{t.position=l.position,l.variables&&this.compose_variables(l.variables,t,n);let c=l.arguments.map(p=>u.lazy?(...f)=>this.compose_argument(p,t,f,l,n):this.compose_argument(p,t,[],l,n)),h=this.apply_func(u,t,c,a,n);j(h)||(o+=h,h.extra&&(i=h.extra))}else o+=l.name}}return o},""),extra:i}}get_composed_value(r,t,n){let i,s=[];return Array.isArray(r)&&(s=r.reduce((o,l)=>{let a=this.compose_value(l,t,n||{});return a&&(a.value&&o.push(a.value),a.extra&&(i=a.extra)),o},[])),{extra:i,group:s,value:s.join(",")}}add_grid_style({fill:r,clip:t,rotate:n,scale:i,translate:s,enlarge:o,skew:l,persp:a,flexRow:u,flexCol:c}){if(r&&this.add_rule(":host",`background-color:${r};`),t||this.add_rule(":host","contain:none;"),n&&this.add_rule(":container",`rotate:${n};`),i&&this.add_rule(":container",`scale:${i};`),s&&this.add_rule(":container",`translate:${s};`),a){let[h,...p]=a;this.add_rule(":container",`perspective:${h};`),p.length&&this.add_rule(":container",`perspective-origin:${p.join(" ")};`)}o&&this.add_rule(":container",`
 width:calc(${o} * 100%);height:calc(${o} * 100%);left:50%;top:50%;transform-origin:0 0;transform:translate(-50%, -50%);`),u&&(this.add_rule(":container","display:flex;"),this.add_rule("cell","flex:1;")),c&&(this.add_rule(":container","display:flex;flex-direction:column;"),this.add_rule("cell","flex:1;"))}compose_rule(r,t,n){let i=Object.assign({},t),s=r.property;if(s==="@seed")return"";let o=this.get_composed_value(r.value,i),l=o.extra,a=o.value;if(/^animation(\-name)?$/.test(s)){if(this.props.has_animation=!0,q(n)){let c=C[s];c&&a&&(a=c+","+a)}if(i.count>1){let{count:c}=i;switch(s){case"animation-name":a=o.group.map(h=>this.compose_aname(h,c)).join(",");break;case"animation":a=o.group.map(h=>{let p=(h||"").split(/\s+/);return p[0]=this.compose_aname(p[0],c),p.join(" ")}).join(",")}}}s==="content"&&(/["']|^none\s?$|^(var|counter|counters|attr|url)\(/.test(a)||(a=`'${a}'`)),s==="transition"&&(this.props.has_transition=!0);let u=`${s}:${a};`;if(u=tr(s,u),s!=="width"&&s!=="height"||mt(n)||(u+=`--_cell-${s}:${a};`),/^(background|background\-image)$/.test(s)&&/\$\{(shader|pattern)/.test(a)&&(u+="background-size:100% 100%;"),/^\-\-/.test(s)&&this.compose_vars(t,n,s,a),/^@/.test(s)&&Ce[s.substr(1)]){let c=s.substr(1),h=Ce[c](a,{is_special_selector:mt(n),grid:i.grid,max_grid:i.max_grid,extra:l});switch(c){case"grid":q(n)?(u=h.size||"",this.add_grid_style(h)):(u="",this.is_grid_set||(h=Ce[c](a,{is_special_selector:!0,grid:i.grid,max_grid:i.max_grid}),this.add_rule(":host",h.size||""),this.add_grid_style(h))),this.grid=i.grid,this.is_grid_set=!0;break;case"gap":u="",this.is_gap_set||(this.add_rule(":container",`gap:${h};`),this.is_gap_set=!0);break;case"content":{u="";let p=this.compose_selector(i);h===void 0||/\:before|\:after/.test(n)||Oe(n)||(this.content[p]=function(f){return f.startsWith('"')&&f.endsWith('"')||f.startsWith("'")&&f.endsWith("'")?f.substring(1,f.length-1):f}(String(h))),this.content[p]=Re.raw({rules:{doodles:this.doodles}})(this.content[p]||"")}case"seed":u="";break;case"place-cell":case"place":case"position":case"offset":q(n)||(u=h);break;case"use":r.value.length&&this.compose(i,r.value),u="";break;default:u=h}}return/^grid/.test(s)&&q(n)&&(this.add_rule(":container",`${s}:${a};`),u=""),u}get_raw_value(r){let t=r.raw();j(t)&&(t="");let[n,...i]=t.split(r.property);return i=i.join(r.property).replace(/^\s*:\s*/,"").replace(/[;}<]$/,"").trim().replace(/[;}<]$/,""),i}compose_vars(r,t,n,i){let s=r.count;Oe(t)&&(s="container"),q(t)&&(s="host"),this.vars[s]||(this.vars[s]={}),this.vars[s][n]=i}pre_compose_rule(r,t,n){let i=Object.assign({},t),s=r.property,o=Object.assign({},this.vars.host,this.vars.container,this.vars[i.count]);if(/^\-\-/.test(s)){let l=this.get_composed_value(r.value,i,o).value;this.compose_vars(t,n,s,l)}switch(s){case"@grid":{let l=this.get_composed_value(r.value,i,o).value,a=s.substr(1),u=Ce[a](l,{max_grid:t.max_grid});this.grid=u.grid;break}case"@use":r.value.length&&this.pre_compose(i,r.value)}}pre_compose(r,t){j(this.seed)&&((t||this.tokens).forEach(n=>{if(n.type==="rule"&&n.property==="@seed"&&(this.seed=this.get_raw_value(n)),n.type==="pseudo"&&q(n.selector))for(let i of be(n.styles))i.type==="rule"&&i.property==="@seed"&&(this.seed=this.get_raw_value(i))}),j(this.seed)||r.update_random(this.seed)),(t||this.tokens).forEach(n=>{switch(n.type){case"rule":this.pre_compose_rule(n,r);break;case"pseudo":q(n.selector)&&(n.styles||[]).forEach(i=>{this.pre_compose_rule(i,r,i.selector)})}})}compose(r,t,n){this.coords.push(r),(t||this.tokens).forEach((i,s)=>{if(i.skip||n&&this.grid)return!1;switch(i.type){case"rule":this.add_rule(this.compose_selector(r),this.compose_rule(i,r));break;case"pseudo":{i.selector.startsWith(":doodle")&&(i.selector=i.selector.replace(/^\:+doodle/,":host"));let o=mt(i.selector);o&&(i.skip=!0),z(i.selector).forEach(l=>{let a=i.styles.map(c=>this.compose_rule(c,r,l)),u=o?l:this.compose_selector(r,l);this.add_rule(u,a)});break}case"cond":{let o=i.name.substr(1),l=yn[o];if(l){let a=i.arguments.map(c=>this.compose_argument(c,r)),u=this.apply_func(l,r,a,o);if(Array.isArray(i.addition))for(let c of i.addition)c==="not"&&(u=!u);u&&(u.selector?i.styles.forEach(c=>{c.type==="rule"&&this.add_rule(u.selector.replaceAll("$",this.compose_selector(r)),this.compose_rule(c,r)),c.type==="pseudo"&&c.selector.split(",").forEach(h=>{let p=c.styles.map(f=>this.compose_rule(f,r,h));this.add_rule((u.selector+h).replaceAll("$",this.compose_selector(r)),p)})}):this.compose(r,i.styles))}break}case"keyframes":this.keyframes[i.name]||(this.keyframes[i.name]=o=>`
 ${xe(i.steps.map(l=>`
 ${this.get_composed_value(l.name,o).value}{${xe(l.styles.map(a=>this.compose_rule(a,o)))}}`))}`)}})}output(){for(let[o,l]of Object.entries(this.rules))if(Oe(o))this.styles.container+=`grid{${xe(l)}}`;else{let a=q(o)?"host":"cells",u=xe(l).trim();if(u.length){let c=a==="host"?`${o},.host`:o;this.styles[a]+=`${c}{${u}}`}}this.uniforms.time&&(this.styles.container+=`
:host,.host{animation:${C.animation};}`,this.styles.keyframes+=`
 @keyframes ${C["animation-name"]}{from{--${C.name}:0} to{--${C.name}:${C["animation-duration"]/10}}}`),this.coords.forEach((o,l)=>{for(let[a,u]of Object.entries(this.keyframes)){let c=this.compose_aname(a,o.count);this.styles.keyframes+=`
 ${l===0?`@keyframes ${a}{${u(o)}}`:""} @keyframes ${c}{${u(o)}}`}});let{keyframes:r,host:t,container:n,cells:i}=this.styles,s=r+t+n;return{props:this.props,styles:{main:s,cells:i,all:s+i},grid:this.grid,seed:this.seed,random:this.random,doodles:this.doodles,shaders:this.shaders,pattern:this.pattern,uniforms:this.uniforms,content:this.content}}}function fr(e,r,t,n,i){let s=new wn(e),o=i||Pe(String(t)),l={};function a(f=0,d){return arguments.length==1&&([f,d]=[0,f]),U(o(),f,d)}function u(...f){let d=f.reduce((m,x)=>m.concat(x),[]);return d[~~(o()*d.length)]}function c(f){let d=[...f],m=f.length;for(;m;){let x=~~(o()*m--),g=d[m];d[m]=d[x],d[x]=g}return d}s.pre_compose({x:1,y:1,z:1,count:1,context:{},grid:{x:1,y:1,z:1,count:1},random:o,rand:a,pick:u,shuffle:c,max_grid:n,update_random:function(f){o=Pe(String(f))},seed_value:t,rules:s});let{grid:h,seed:p}=s.output();if(h&&(r=h),p?(p=String(p),o=Pe(p)):p=t,j(p)&&(p=Date.now(),o=Pe(p)),p=String(p),s.seed=p,s.random=o,s.reset(),r.z==1)for(let f=1,d=0;f<=r.y;++f)for(let m=1;m<=r.x;++m)s.compose({x:m,y:f,z:1,count:++d,grid:r,context:l,rand:a,pick:u,shuffle:c,random:o,seed:p,max_grid:n,rules:s});else for(let f=1,d=0;f<=r.z;++f)s.compose({x:1,y:1,z:f,count:++d,grid:r,context:l,rand:a,pick:u,shuffle:c,random:o,seed:p,max_grid:n,rules:s});return s.output()}function dr(e,r,t){let n=e.createShader(r);return e.shaderSource(n,t),e.compileShader(n),n}function J(e,r){return e.includes(r)?e:r+`
`+e}function mr(e,r){let t=K.get(e);if(t)return Promise.resolve(t);let n=document.createElement("canvas"),i=devicePixelRatio||1,s=n.width=e.width*i,o=n.height=e.height*i,l=[],a=n.getContext("webgl2",{preserveDrawingBuffer:!0});if(!a)return Promise.resolve("");let u=J(e.fragment||"","uniform vec2 u_resolution;");u=J(u,"uniform float u_time;"),u=J(u,"uniform float u_timeDelta;"),u=J(u,"uniform int u_frameIndex;"),u=J(u,"uniform vec2 u_seed;"),e.textures.forEach(v=>{let _=`uniform sampler2D ${v.name};`;u=J(u,_)}),/(^|[^\w\_])void\s+mainImage\(\s*out\s+vec4\s+fragColor,\s*in\s+vec2\s+fragCoord\s*\)/gm.test(u)&&(u=`
#define iResolution vec3(u_resolution, 0)
#define iTime u_time
#define iTimeDelta u_timeDelta
#define iFrame u_frameIndex

${e.textures.map((v,_)=>`#define iChannel${_} ${v.name}`).join(`
`)}
${u}
void main(){mainImage(FragColor, gl_FragCoord.xy);}`);let c=function(v,_,b){let w=dr(v,v.VERTEX_SHADER,_),S=dr(v,v.FRAGMENT_SHADER,b),k=v.createProgram();return v.attachShader(k,w),v.attachShader(k,S),v.linkProgram(k),v.getProgramParameter(k,v.LINK_STATUS)||(console.warn("Link failed:"+v.getProgramInfoLog(k)),console.warn("vs info-log:"+v.getShaderInfoLog(w)),console.warn("fs info-log:"+v.getShaderInfoLog(S))),k}(a,e.vertex||`#version 300 es
 in vec4 position;void main(){gl_Position = position;}`,`#version 300 es
 precision highp float;out vec4 FragColor;`+u),h=a.getAttribLocation(c,"position"),p=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,p),a.bufferData(a.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,-1,1,1,-1,1,1,-1]),a.STATIC_DRAW),a.enableVertexAttribArray(h),a.vertexAttribPointer(h,2,a.FLOAT,!1,0,0),a.viewport(0,0,a.drawingBufferWidth,a.drawingBufferHeight),a.clearColor(0,0,0,0),a.clear(a.COLOR_BUFFER_BIT),a.useProgram(c);const f=v=>a.getUniformLocation(c,v),d=f("u_resolution");a.uniform2fv(d,[s,o]),e.textures.forEach((v,_)=>{l.push(function(b,w,S){const k=b.createTexture();return b.activeTexture(b["TEXTURE"+S]),b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!0),b.bindTexture(b.TEXTURE_2D,k),b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,w),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.REPEAT),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.REPEAT),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.LINEAR),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.LINEAR),k}(a,v.value,_)),a.uniform1i(a.getUniformLocation(c,v.name),_)});const m=f("u_seed");m&&a.uniform2f(m,St(r)/1e16,Math.random());const x=f("u_time"),g=f("u_frameIndex"),y=f("u_timeDelta");if(x||y||g){let v=0,_=0;return Promise.resolve(K.set(e,(b,w,S,k)=>(a.clear(a.COLOR_BUFFER_BIT),e.width===w&&e.height===S||(k.forEach((R,N)=>{a.bindTexture(a.TEXTURE_2D,l[N]),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,R.value)}),e.width=w,e.height=S,n.width=w*i,n.height=S*i,a.viewport(0,0,n.width,n.height),a.uniform2fv(d,[n.width,n.height])),x&&a.uniform1f(x,b/1e3),g&&a.uniform1i(g,v++),y&&(a.uniform1f(y,(_-b)/1e3),_=b),a.drawArrays(a.TRIANGLES,0,6),n.toDataURL())))}return a.drawArrays(a.TRIANGLES,0,6),Promise.resolve(K.set(e,n.toDataURL()))}function kn(e,r){let t=[];for(;e.next();){let{curr:n,next:i}=e.get(),s=!i||n.isSymbol(";")||i.isSymbol("}");if(t.push(n),s)break}return t.length&&(r.value=gt(t)),r}function gr(e,r){let t=[],n=[],i=r&&r.type||"",s=[];for(;e.next();){let{prev:o,curr:l,next:a}=e.get(),u=!a||l.isSymbol("}");if(i==="block"&&u){a||!t.length||l.isSymbol("}")||(t[t.length-1].value+=";"+l.value),r.value=t;break}if(l.isSymbol("{")&&n.length&&!s.length){let c=Sn(n);if(!c.length)continue;let h=gr(e,{type:"block",name:"unkown",value:[]});c.forEach(p=>{let f=Object.assign({},h,{name:p.name,args:p.args});t.push(f)}),n=[]}else if(l.isSymbol(":")&&n.length&&!s.length){let c=gt(n);t.push(kn(e,{type:"statement",name:c,value:""})),i=="block"&&(r.value=t),n=[]}else l.isSymbol(";")?t.length&&n.length&&(t[t.length-1].value+=";"+gt(n),n=[]):(l.isSymbol("(")&&s.push(l),l.isSymbol(")")&&s.pop(),n.push(l))}return t.length&&i=="block"&&(r.value=t),i?r:t}function gt(e){return e.filter((r,t)=>!r.isSymbol(";")||t!==e.length-1).map(r=>r.value).join("")}function Sn(e){let r=I(e),t=[],n="",i=[],s=[],o=[];for(;r.next();){let{curr:l,next:a}=r.get();!n.length&&l.isWord()?n=l.value:l.isSymbol("(")?(o.length&&s.push(l.value),o.push(l)):l.isSymbol(")")?(o.pop(),o.length?s.push(l.value):s.length&&(i.push(s.join("")),s=[])):l.isSymbol(",")?o.length?(i.push(s.join("")),s=[]):(s.length&&(i.push(s.join("")),s=[]),n&&(t.push({name:n,args:i}),n="",i=[],s=[])):s.push(l.value)}return n&&t.push({name:n,args:i}),t.filter((l,a,u)=>u.findIndex(c=>c.name===l.name&&l.args.join("")==c.args.join(""))===a)}function jn(e){return gr(I(D(e)))}function vr(e,r){if(e.name==="fill"){let{r:t,g:n,b:i,a:s}=r.get_rgba_color(e.value);return{type:"statement",value:`
color = vec4(${Ie(t/255)}, ${Ie(n/255)}, ${Ie(i/255)}, ${Ie(s)});`}}return e.name=="grid"?{type:"grid",value:e.value}:{type:"statement",value:""}}function Ie(e){return String(e).includes(".")?e:e+".0"}function An(e,r){let t=jn(e),n=[],i={x:1,y:1};return t.forEach(s=>{if(s.type==="statement"){let o=vr(s,r);o.type=="statement"&&n.push(o.value),o.type==="grid"&&(i=ne(o.value,1/0))}else s.type==="block"&&n.push(function(o,l){if(o.name==="match"){let a=o.args[0],u=[];return o.value.forEach(c=>{let h=vr(c,l);h.type=="statement"&&u.push(h.value)}),`
 if (${a}){${u.join("")}}`}return""}(s,r))}),function(s,{x:o,y:l}){return`
 vec3 mapping(vec2 uv, vec2 grid){vec2 _grid = 1.0/grid;float x = ceil(uv.x/_grid.x);float y = ceil(grid.y - uv.y/_grid.y);float i = x + (y - 1.0) * y;return vec3(x, y, i);} vec4 getColor(float x, float y, float i, float I, float X, float Y, float t){vec4 color = vec4(0, 0, 0, 0);${s} return color;} void main(){vec2 uv = gl_FragCoord.xy/u_resolution.xy;vec2 v = vec2(${o}, ${l});vec3 p = mapping(uv, v);FragColor = getColor(p.x, p.y, p.z, v.x * v.y, v.x, v.y, u_time);}`}(n.join(""),i)}function Nn(e){if(typeof getComputedStyle>"u")return"";let r={};if(e.computedStyleMap)for(let[t,n]of e.computedStyleMap())t.startsWith("--")&&(r[t]=n[0][0]);else{let t=getComputedStyle(e);for(let n of t)n.startsWith("--")&&(r[n]=t.getPropertyValue(n))}return function(t){let n=[];for(let[i,s]of Object.entries(t))n.push(i+":"+s);return n.join(";")}(r)}const yr=1e3/60;if(typeof customElements<"u"){class e extends HTMLElement{constructor(){super(),this.doodle=this.attachShadow({mode:"open"}),this.animations=[],this.extra={get_variable:t=>function(n,i){return typeof getComputedStyle>"u"?"":getComputedStyle(n).getPropertyValue(i).trim().replace(/^\(|\)$/g,"")}(this,t),get_rgba_color:t=>function(n,i){let s=n.querySelector("style");return s?(s.style.color=i,function(o){let[l,a,u,c=1]=o.replace(/rgba?\((.+)\)/,(h,p)=>p).split(/,\s*/);return{r:l,g:a,b:u,a:c}}(getComputedStyle(s).color)):{r:0,g:0,b:0,a:1}}(this.shadowRoot,t)}}connectedCallback(t){this.innerHTML?this.load(t):setTimeout(()=>this.load(t))}disconnectedCallback(){this.cleanup()}cleanup(){K.clear();for(let t of this.animations)t.cancel();this.animations=[]}update(t){this.cleanup(),t||(t=kt(this._innerHTML)),this._innerHTML!==t&&(this._innerHTML=t),this.grid_size||(this.grid_size=this.get_grid());const{x:n,y:i,z:s}=this.grid_size,o=this.get_use();let l="",a="";this.compiled&&(l=this.compiled.content,a=this.compiled.styles.all);const u=this.generate(Z(o+t,this.extra));let c=u.grid||this.get_grid(),{x:h,y:p,z:f}=c,d=!this.shadowRoot.innerHTML||this.shadowRoot.querySelector("css-doodle")||n!==h||i!==p||s!==f||JSON.stringify(l)!==JSON.stringify(u.content);if(Object.assign(this.grid_size,c),d)return u.grid?this.build_grid(u,c):this.build_grid(this.generate(Z(o+t,this.extra)),c);let m=this.replace(u);u.props.has_animation&&(this.set_style(a.replace(/animation/g,"x")),this.reflow()),this.set_style(m(We(this.grid_size)+u.styles.all))}get grid(){return Object.assign({},this.grid_size)}set grid(t){this.attr("grid",t),this.connectedCallback(!0)}get seed(){return this._seed_value}set seed(t){this.attr("seed",t),this.connectedCallback(!0)}get use(){return this.attr("use")}set use(t){this.attr("use",t),this.connectedCallback(!0)}get_max_grid(){return this.hasAttribute("experimental")?256:64}get_grid(){return ne(this.attr("grid"),this.get_max_grid())}get_use(){let t=String(this.attr("use")||"").trim();return/^var\(/.test(t)&&(t=`@use:${t};`),t}attr(t,n){let i=arguments.length;return i===1?this.getAttribute(t):i===2?(this.setAttribute(t,n),n):void 0}generate(t){let n=this.get_grid(),i=this.attr("seed")||this.attr("data-seed");j(i)&&(i=Date.now());let s=this.compiled=fr(t,n,i,this.get_max_grid());return this._seed_value=s.seed,this._seed_random=s.random,s}doodle_to_image(t,n,i){typeof n=="function"&&(i=n,n=null);let s=Z(t=":doodle{width:100%;height:100%}"+t,this.extra),o=ne(""),l=fr(s,o,this._seed_value,this.get_max_grid(),this._seed_random),a=l.grid?l.grid:o,u="";if(n&&n.arg){let p=ne(n.arg,1/0);p.x&&p.y&&(n.width=p.x+"px",n.height=p.y+"px",u=`viewBox="0 0 ${p.x} ${p.y}"`)}let c=this.replace(l),h=_r(a,l.content);c(`
<svg ${n&&n.width&&n.height?`width="${n.width}" height="${n.height}"`:""} ${ie} preserveAspectRatio="none" ${u}><foreignObject width="100%" height="100%"><div class="host" width="100%" height="100%" ${Lt}><style>${We(a)} ${l.styles.all}</style>${h}</div></foreignObject></svg>`).then(p=>{let f=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(p)))}`;Be()&&wt(f),i(f)})}pattern_to_image({code:t,cell:n,id:i},s){let o=An(t,this.extra);this.shader_to_image({shader:o,cell:n,id:i},s)}pause(){this.setAttribute("cssd-paused",!0);for(let t of this.animations)t.pause()}resume(){this.removeAttribute("cssd-paused");for(let t of this.animations)t.resume()}shader_to_image({shader:t,cell:n,id:i},s){const o=this.doodle.getElementById(n);if(!o)return!1;let{width:l,height:a}=o.getBoundingClientRect(),u=devicePixelRatio||1,c=this.seed,h=typeof t=="string"?function(g){let y,v,_=I(Wt(D(g,{preserveLineBreak:!0,ignoreInlineComment:!0}))),b=[],w=[],S={textures:[]};for(;_.next();){let{curr:k,next:R}=_.get();if(k.isSymbol("{")){if(b.length)w.push(k);else{let N=Ze(w);Kr(N)?(y=N,w=[]):w.push(k)}b.push("{")}else if(k.isSymbol("}"))if(b.pop(),!b.length&&y){let N=Ze(w);y&&N.length&&(y.startsWith("texture")?S.textures.push({name:y,value:N}):S[y]=N,w=[]),y=null}else w.push(k);else B(v)||v==k.pos[1]||(w.push(It()),v=null),y&&y.startsWith("texture")||k.isWord()&&k.value.startsWith("#")&&(w.push(It()),v=R.pos[1]),w.push(k)}return B(S.fragment)&&(S.fragment=Ze(w),S.textures=S.textures||[]),S}(t):t;h.width=l,h.height=a;let p=h.textures,f=[];const d=g=>{o.style.setProperty(i,`url(${g})`)},m=g=>{typeof g=="function"?this.animations.push(function(y){let v,_=0,b=0,w=0,S=!1;function k(R){_||(_=R),y(_);let N=R-b;N<yr&&(N=yr),N>1e3&&(N=w||1e3),b&&(_+=N),w=N,b=R,v=requestAnimationFrame(k)}return v=requestAnimationFrame(k),{resume(){v&&S&&(S=!1,v=requestAnimationFrame(k))},pause(){v&&(cancelAnimationFrame(v),S=!0)},cancel(){v&&(S=!1,cancelAnimationFrame(v),v=null)}}}(y=>{d(g(y,l,a,f))})):d(g)},x=(g,y)=>{Promise.all(g.map(({name:v,value:_})=>new Promise(b=>{this.doodle_to_image(_,{width:l,height:a},w=>{let S=new Image;S.width=l*u,S.height=l*u,S.onload=()=>b({name:v,value:S}),S.src=w})}))).then(y)};o.observer||(o.observer=new ResizeObserver(()=>{let g=o.getBoundingClientRect();l=g.width,a=g.height,x(p,y=>f=y)}),o.observer.observe(o)),p.length?x(p,g=>{h.textures=f=g,h.width=l,h.height=a,mr(h,c).then(m).then(s)}):mr(h,c).then(m).then(s)}load(t){this.cleanup();let n=Z(this.get_use()+kt(this.innerHTML),this.extra),i=this.generate(n);t||this.hasAttribute("click-to-update")&&this.addEventListener("click",s=>this.update()),this.grid_size=i.grid?i.grid:this.get_grid(),this.build_grid(i,this.grid_size),this._innerHTML=this.innerHTML,this.innerHTML=""}replace({doodles:t,shaders:n,pattern:i}){let s=Object.keys(t),o=Object.keys(n),l=Object.keys(i),a=s.length+o.length+l.length;return u=>{if(!a)return Promise.resolve(u);let c=[].concat(s.map(h=>u.includes(h)?new Promise(p=>{let{arg:f,doodle:d}=t[h];this.doodle_to_image(d,{arg:f},m=>p({id:h,value:m}))}):Promise.resolve("")),o.map(h=>u.includes(h)?new Promise(p=>{this.shader_to_image(n[h],f=>p({id:h,value:f}))}):Promise.resolve("")),l.map(h=>u.includes(h)?new Promise(p=>{this.pattern_to_image(i[h],f=>p({id:h,value:f}))}):Promise.resolve("")));return Promise.all(c).then(h=>{for(let{id:p,value:f}of h){let d=`url(${f})`;/^shader|^pattern/.test(p)&&(d=`var(--${p})`),u=u.replaceAll("${"+p+"}",d)}return u})}}reflow(){this.shadowRoot.querySelector("grid").offsetWidth}build_grid(t,n){const{has_transition:i,has_animation:s}=t.props;let o=i||s;const{uniforms:l,content:a,styles:u}=t;this.doodle.innerHTML=`
<style>${We(n)+u.main}</style>${_r(n,a)}`,o&&this.reflow();let c=this.replace(t);this.set_style(c(We(n)+u.all)),l.time&&this.register_utime(),l.mousex||l.mousey?this.register_umouse(l):this.remove_umouse(),l.width||l.height?this.register_usize(l):this.remove_usize()}register_umouse(t){if(!this.umouse_fn){this.umouse_fn=i=>{let s=i.detail||i;t.mousex&&this.style.setProperty("--"+rt,s.offsetX),t.mousey&&this.style.setProperty("--"+nt,s.offsetY)},this.addEventListener("pointermove",this.umouse_fn);let n=new CustomEvent("pointermove",{detail:{offsetX:0,offsetY:0}});this.dispatchEvent(n)}}remove_umouse(){this.umouse_fn&&(this.style.removeProperty("--"+rt),this.style.removeProperty("--"+nt),this.removeEventListener("pointermove",this.umouse_fn),this.umouse_fn=null)}register_usize(t){this.usize_observer||(this.usize_observer=new ResizeObserver(()=>{let n=this.getBoundingClientRect();t.width&&this.style.setProperty("--"+it,n.width),t.height&&this.style.setProperty("--"+st,n.height)}),this.usize_observer.observe(this))}remove_usize(){this.usize_observer&&(this.style.removeProperty("--"+it),this.style.removeProperty("--"+st),this.usize_observer.unobserve(this),this.usize_observer=null)}register_utime(){if(!this.is_utime_set){try{CSS.registerProperty({name:"--"+C.name,syntax:"<number>",initialValue:0,inherits:!0})}catch{}this.is_utime_set=!0}}export({scale:t,name:n,download:i,detail:s}={}){return new Promise((o,l)=>{let a=Nn(this),u=this.doodle.innerHTML,{width:c,height:h}=this.getBoundingClientRect(),p=c*(t=parseInt(t)||1),f=h*t,d=`
<svg ${ie} preserveAspectRatio="none"
 viewBox="0 0 ${c} ${h}"
 ${Be()?"":`width="${p}px" height="${f}px"`}><foreignObject width="100%" height="100%"><div class="host" ${Lt} style="width:${c}px;height:${h}px"><style>.host{${m=a,m.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}}</style>${u}</div></foreignObject></svg>`;var m;i||s?function(x,g,y,v){return new Promise((_,b)=>{let w=`data:image/svg+xml;utf8,${encodeURIComponent(x)}`;function S(){let k=new Image;k.crossOrigin="anonymous",k.src=w,k.onload=()=>{let R=document.createElement("canvas"),N=R.getContext("2d"),O=devicePixelRatio||1;v!=1&&(O=1),R.width=g*O,R.height=y*O,N.drawImage(k,0,0,R.width,R.height);try{R.toBlob(M=>{_({blob:M,source:w,url:URL.createObjectURL(M)})})}catch(M){b(M)}}}Be()?wt(w,S,200):S()})}(d,p,f,t).then(({source:x,url:g,blob:y})=>{if(o({width:p,height:f,svg:d,blob:y,source:x}),i){let v=document.createElement("a");v.download=function(_){return(j(_)?Date.now():String(_).replace(/\/.png$/g,""))+".png"}(n),v.href=g,v.click()}}).catch(x=>{l(x)}):o({width:p,height:f,svg:d})})}set_style(t){if(t instanceof Promise)t.then(n=>{this.set_style(n)});else{const n=this.shadowRoot.querySelector("style");let i=t.replace(/\n\s+/g," ");n&&(n.styleSheet?n.styleSheet.cssText=i:n.innerHTML=i)}}}customElements.get("css-doodle")||customElements.define("css-doodle",e)}function We(e){let{x:r,y:t}=e||{};return`
 *,*::after,*::before{box-sizing:border-box;}:host,.host{display:block;visibility:visible;width:auto;height:auto;contain:content;box-sizing:border-box;--${C.name}:0
}:host([hidden]),[hidden]{display:none
}:host([cssd-paused]),
:host([cssd-paused]) *{animation-play-state:paused !important
} grid, cell{display:grid;position:relative;} grid{gap:inherit;grid-template:repeat(${t},1fr)/repeat(${r},1fr)
} cell{place-items:center
} svg{position:absolute;} grid, svg{width:100%;height:100%
}`}function br(e){return j(e)?"":e}function xr(e,r,t,n,i=""){let s=ee(e,r,t);return`<cell id="${s}">${br(n["#"+s])}${br(i)}</cell>`}function _r(e,r){let{x:t,y:n,z:i}=e||{},s="";if(i==1)for(let o=1;o<=n;++o)for(let l=1;l<=t;++l)s+=xr(l,o,1,r);else{let o="";for(let l=i;l>=1;l--)o=xr(1,1,l,r,o);s=o}return`<grid>${s}</grid>`}})();
